<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>STAGE 3: OPERATIONAL DOCTRINE -- PLATFORM &amp; CORE SYSTEMS - holm.chat</title>
<link rel="stylesheet" href="style.css">
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%2032%2032%22%3E%20%20%3Crect%20width=%2232%22%20height=%2232%22%20rx=%224%22%20fill=%22%231a1a2e%22/%3E%20%20%3Ctext%20x=%2216%22%20y=%2222%22%20font-family=%22monospace%22%20font-size=%2218%22%20font-weight=%22bold%22%20fill=%22%23e0e0e0%22%20text-anchor=%22middle%22%3EH%3C/text%3E%3C/svg%3E">
</head>
<body>
<header class="site-header">
<div class="header-inner">
<a href="index.html" class="site-title">holm.chat</a>
<span class="site-subtitle">Documentation Institution</span>
</div>
<nav class="site-nav"><ul>
<li><a href="index.html">Home</a></li>
<li><a href="domains-1-5.html">Domains 1-5</a></li>
<li><a href="domains-6-10.html">Domains 6-10</a></li>
<li><a href="domains-11-15.html">Domains 11-15</a></li>
<li><a href="domains-16-20.html">Domains 16-20</a></li>
<li><a href="meta-framework.html">Meta-Framework</a></li>
<li><a href="core-charter.html">Core Charter</a></li>
<li><a href="philosophy-batch2.html">Philosophy Batch2</a></li>
<li><a href="philosophy-batch3.html">Philosophy Batch3</a></li>
<li><a href="philosophy-batch4.html">Philosophy Batch4</a></li>
<li><a href="automation-ops.html">Automation Ops</a></li>
<li><a href="data-ops.html">Data Ops</a></li>
<li><a href="education-ops.html">Education Ops</a></li>
<li><a href="ethics-quality-ops.html">Ethics Quality Ops</a></li>
<li><a href="federation-ops.html">Federation Ops</a></li>
<li><a href="governance-ops.html">Governance Ops</a></li>
<li><a href="intel-ops.html">Intel Ops</a></li>
<li><a href="interface-ops.html">Interface Ops</a></li>
<li><a href="ops-batch1.html">Ops Batch1</a></li>
<li><a href="ops-batch2.html">Ops Batch2</a></li>
<li><a href="ops-batch3.html">Ops Batch3</a></li>
<li class="active"><a href="platform-ops.html">Platform Ops</a></li>
<li><a href="automation-advanced.html">Automation Advanced</a></li>
<li><a href="data-advanced.html">Data Advanced</a></li>
<li><a href="evolution-memory-advanced.html">Evolution Memory Advanced</a></li>
<li><a href="federation-import-advanced.html">Federation Import Advanced</a></li>
<li><a href="hic-architecture.html">Hic Architecture</a></li>
<li><a href="hic-interaction.html">Hic Interaction</a></li>
<li><a href="hic-knowledge-mapping.html">Hic Knowledge Mapping</a></li>
<li><a href="hic-master-blueprint.html">Hic Master Blueprint</a></li>
<li><a href="hic-offline-rendering.html">Hic Offline Rendering</a></li>
<li><a href="hic-spatial-data.html">Hic Spatial Data</a></li>
<li><a href="hic-visual-design.html">Hic Visual Design</a></li>
<li><a href="infrastructure-advanced.html">Infrastructure Advanced</a></li>
<li><a href="research-advanced.html">Research Advanced</a></li>
<li><a href="security-advanced.html">Security Advanced</a></li>
<li><a href="meta-batch1.html">Meta Batch1</a></li>
<li><a href="meta-batch2.html">Meta Batch2</a></li>
<li><a href="meta-batch3.html">Meta Batch3</a></li>
</ul></nav>
</header>
<div class="layout">
<aside class="sidebar">
<nav class="toc"><h2 class="toc-title">Table of Contents</h2><ul>
<li><a href="#stage-3-operational-doctrine-platform-core-systems">STAGE 3: OPERATIONAL DOCTRINE -- PLATFORM &amp; CORE SYSTEMS</a></li>
<ul>
<li><a href="#domain-5-operations-articles-d5-002-through-d5-006">Domain 5 Operations Articles D5-002 through D5-006</a></li>
<li><a href="#how-to-read-this-document">How to Read This Document</a></li>
</ul>
<li><a href="#d5-002-operating-system-maintenance-procedures">D5-002 -- Operating System Maintenance Procedures</a></li>
<ul>
<li><a href="#1-purpose">1. Purpose</a></li>
<li><a href="#2-scope">2. Scope</a></li>
<li><a href="#3-background">3. Background</a></li>
<ul>
<li><a href="#31-the-air-gap-maintenance-paradox">3.1 The Air-Gap Maintenance Paradox</a></li>
</ul>
<li><a href="#4-system-model">4. System Model</a></li>
<ul>
<li><a href="#41-the-update-pipeline">4.1 The Update Pipeline</a></li>
<li><a href="#42-the-security-patch-triage-matrix">4.2 The Security Patch Triage Matrix</a></li>
<li><a href="#43-kernel-management">4.3 Kernel Management</a></li>
<li><a href="#44-the-test-suite">4.4 The Test Suite</a></li>
<li><a href="#45-production-verification-checklist">4.5 Production Verification Checklist</a></li>
<li><a href="#46-the-upgrade-decision-framework">4.6 The Upgrade Decision Framework</a></li>
</ul>
<li><a href="#5-rules-constraints">5. Rules &amp; Constraints</a></li>
<li><a href="#6-failure-modes">6. Failure Modes</a></li>
<li><a href="#7-recovery-procedures">7. Recovery Procedures</a></li>
<li><a href="#8-evolution-path">8. Evolution Path</a></li>
<li><a href="#9-commentary-section">9. Commentary Section</a></li>
<li><a href="#10-references">10. References</a></li>
</ul>
<li><a href="#d5-003-core-service-configuration-and-hardening">D5-003 -- Core Service Configuration and Hardening</a></li>
<ul>
<li><a href="#1-purpose-1">1. Purpose</a></li>
<li><a href="#2-scope-1">2. Scope</a></li>
<li><a href="#3-background-1">3. Background</a></li>
<ul>
<li><a href="#31-the-service-dependency-map">3.1 The Service Dependency Map</a></li>
</ul>
<li><a href="#4-system-model-1">4. System Model</a></li>
<ul>
<li><a href="#41-configuration-baselines">4.1 Configuration Baselines</a></li>
<li><a href="#42-hardening-checklists-by-service">4.2 Hardening Checklists by Service</a></li>
<li><a href="#43-configuration-drift-detection">4.3 Configuration Drift Detection</a></li>
</ul>
<li><a href="#5-rules-constraints-1">5. Rules &amp; Constraints</a></li>
<li><a href="#6-failure-modes-1">6. Failure Modes</a></li>
<li><a href="#7-recovery-procedures-1">7. Recovery Procedures</a></li>
<li><a href="#8-evolution-path-1">8. Evolution Path</a></li>
<li><a href="#9-commentary-section-1">9. Commentary Section</a></li>
<li><a href="#10-references-1">10. References</a></li>
</ul>
<li><a href="#d5-004-network-architecture-and-segmentation">D5-004 -- Network Architecture and Segmentation</a></li>
<ul>
<li><a href="#1-purpose-2">1. Purpose</a></li>
<li><a href="#2-scope-2">2. Scope</a></li>
<li><a href="#3-background-2">3. Background</a></li>
<ul>
<li><a href="#31-why-segment-an-air-gapped-network">3.1 Why Segment an Air-Gapped Network?</a></li>
</ul>
<li><a href="#4-system-model-2">4. System Model</a></li>
<ul>
<li><a href="#41-physical-network-topology">4.1 Physical Network Topology</a></li>
<li><a href="#42-wireless-policy">4.2 Wireless Policy</a></li>
<li><a href="#43-logical-network-segmentation">4.3 Logical Network Segmentation</a></li>
<li><a href="#44-firewall-rules-architecture">4.4 Firewall Rules Architecture</a></li>
<li><a href="#45-the-air-gap-exception-register">4.5 The Air-Gap Exception Register</a></li>
<li><a href="#46-network-monitoring">4.6 Network Monitoring</a></li>
</ul>
<li><a href="#5-rules-constraints-2">5. Rules &amp; Constraints</a></li>
<li><a href="#6-failure-modes-2">6. Failure Modes</a></li>
<li><a href="#7-recovery-procedures-2">7. Recovery Procedures</a></li>
<li><a href="#8-evolution-path-2">8. Evolution Path</a></li>
<li><a href="#9-commentary-section-2">9. Commentary Section</a></li>
<li><a href="#10-references-2">10. References</a></li>
</ul>
<li><a href="#d5-005-system-monitoring-and-alerting">D5-005 -- System Monitoring and Alerting</a></li>
<ul>
<li><a href="#1-purpose-3">1. Purpose</a></li>
<li><a href="#2-scope-3">2. Scope</a></li>
<li><a href="#3-background-3">3. Background</a></li>
<ul>
<li><a href="#31-monitoring-in-an-air-gapped-environment">3.1 Monitoring in an Air-Gapped Environment</a></li>
</ul>
<li><a href="#4-system-model-3">4. System Model</a></li>
<ul>
<li><a href="#41-what-to-monitor">4.1 What to Monitor</a></li>
<li><a href="#42-how-to-monitor">4.2 How to Monitor</a></li>
<li><a href="#43-alert-thresholds-and-classification">4.3 Alert Thresholds and Classification</a></li>
<li><a href="#44-dashboard-design">4.4 Dashboard Design</a></li>
<li><a href="#45-the-daily-health-check-procedure">4.5 The Daily Health Check Procedure</a></li>
<li><a href="#46-what-normal-looks-like">4.6 What &quot;Normal&quot; Looks Like</a></li>
</ul>
<li><a href="#5-rules-constraints-3">5. Rules &amp; Constraints</a></li>
<li><a href="#6-failure-modes-3">6. Failure Modes</a></li>
<li><a href="#7-recovery-procedures-3">7. Recovery Procedures</a></li>
<li><a href="#8-evolution-path-3">8. Evolution Path</a></li>
<li><a href="#9-commentary-section-3">9. Commentary Section</a></li>
<li><a href="#10-references-3">10. References</a></li>
</ul>
<li><a href="#d5-006-configuration-management-without-internet">D5-006 -- Configuration Management Without Internet</a></li>
<ul>
<li><a href="#1-purpose-4">1. Purpose</a></li>
<li><a href="#2-scope-4">2. Scope</a></li>
<li><a href="#3-background-4">3. Background</a></li>
<ul>
<li><a href="#31-the-configuration-lifecycle">3.1 The Configuration Lifecycle</a></li>
</ul>
<li><a href="#4-system-model-4">4. System Model</a></li>
<ul>
<li><a href="#41-the-version-control-system">4.1 The Version Control System</a></li>
<li><a href="#42-the-change-management-process">4.2 The Change Management Process</a></li>
<li><a href="#43-manual-vs-automated-deployment">4.3 Manual vs. Automated Deployment</a></li>
<li><a href="#44-the-configuration-audit">4.4 The Configuration Audit</a></li>
<li><a href="#45-configuration-reproducibility">4.5 Configuration Reproducibility</a></li>
<li><a href="#46-interaction-with-other-operational-articles">4.6 Interaction with Other Operational Articles</a></li>
</ul>
<li><a href="#5-rules-constraints-4">5. Rules &amp; Constraints</a></li>
<li><a href="#6-failure-modes-4">6. Failure Modes</a></li>
<li><a href="#7-recovery-procedures-4">7. Recovery Procedures</a></li>
<li><a href="#8-evolution-path-4">8. Evolution Path</a></li>
<li><a href="#9-commentary-section-4">9. Commentary Section</a></li>
<li><a href="#10-references-4">10. References</a></li>
</ul></ul>
</nav>
</aside>
<main class="content">
<h1 id="stage-3-operational-doctrine-platform-core-systems">STAGE 3: OPERATIONAL DOCTRINE -- PLATFORM & CORE SYSTEMS</h1>
<h2 id="domain-5-operations-articles-d5-002-through-d5-006">Domain 5 Operations Articles D5-002 through D5-006</h2>
<p><strong>Document ID:</strong> STAGE3-PLATFORM-OPS <strong>Version:</strong> 1.0.0 <strong>Date:</strong> 2026-02-16 <strong>Status:</strong> Ratified <strong>Classification:</strong> Stage 3 -- Operational Doctrine. Practical manuals for the daily operation of the institution's platform layer. <strong>Depends On:</strong> ETH-001, CON-001, GOV-001, SEC-001, OPS-001, Stage 1 Domain 5 Framework <strong>Depended Upon By:</strong> All articles involving platform maintenance, system administration, network operations, or configuration management.</p>
<hr/>
<h2 id="how-to-read-this-document">How to Read This Document</h2>
<p>This document contains five operational articles for Domain 5: Platform & Core Systems. These are not philosophical documents. They are manuals. They tell you what to do, when to do it, and what to do when something goes wrong.</p>
<p>Each article follows the canonical template defined in Stage 1. Each article traces its authority back to the root documents in Stage 2. Where a procedure in this document conflicts with a principle in Stage 2, the principle prevails and this document must be amended.</p>
<p>These articles assume you have read OPS-001 (Operations Philosophy) and understand the operational tempo. They assume you have read SEC-001 (Threat Model and Security Philosophy) and understand the air-gap constraint. If you have not read those documents, stop here and read them first. The procedures in this document will not make sense without that context.</p>
<p>If you are performing a specific task and need a specific procedure, use the table of contents below to navigate directly. If you are reading for the first time, read sequentially. The articles build on one another.</p>
<hr/>
<hr/>
<h1 id="d5-002-operating-system-maintenance-procedures">D5-002 -- Operating System Maintenance Procedures</h1>
<p><strong>Document ID:</strong> D5-002 <strong>Domain:</strong> 5 -- Platform & Core Systems <strong>Version:</strong> 1.0.0 <strong>Date:</strong> 2026-02-16 <strong>Status:</strong> Ratified <strong>Depends On:</strong> ETH-001, CON-001, SEC-001, OPS-001, P-001, P-002, P-003, P-012 <strong>Depended Upon By:</strong> D5-003, D5-004, D5-005, D5-006, all Domain 12 (Disaster Recovery) articles involving system rebuilds.</p>
<hr/>
<h2 id="1-purpose">1. Purpose</h2>
<p>This article defines how the operating system is maintained on every machine within the institution. Maintenance means patching, updating, upgrading, and occasionally choosing not to do any of those things. In a conventional, internet-connected environment, operating system maintenance is largely automated: package managers pull updates from remote repositories, security patches arrive through automatic update services, and the operator's primary decision is whether to reboot now or later. None of that applies here.</p>
<p>This institution is air-gapped. There are no remote repositories. There are no automatic updates. There is no mechanism by which a security advisory will appear on your screen unbidden. Every update that enters this institution does so because a human being physically transported it across the air gap, verified its integrity, tested it in isolation, and deliberately applied it. This article defines the procedures that make that process reliable, repeatable, and safe.</p>
<p>The purpose is not merely technical. Operating system maintenance in an air-gapped environment is a governance act. Every patch applied is a decision to trust external code. Every patch withheld is a decision to accept a known vulnerability. Both decisions carry risk. Both decisions must be documented. This article provides the framework for making those decisions well.</p>
<h2 id="2-scope">2. Scope</h2>
<p>This article covers:</p>
<ul>
<li>The process for identifying which OS updates are available and relevant.</li>
<li>The process for acquiring updates across the air gap.</li>
<li>The process for testing updates before production deployment.</li>
<li>The process for applying updates to production systems.</li>
<li>Rollback procedures when updates cause problems.</li>
<li>Kernel management: when to update the kernel, when to hold.</li>
<li>The decision framework for major version upgrades versus staying on a current release.</li>
<li>Security patch triage for offline systems.</li>
</ul>
<p>This article does NOT cover:</p>
<ul>
<li>The initial operating system installation (see P-003).</li>
<li>Application-level software updates (see D5-006 for configuration management, P-002 for software acquisition).</li>
<li>Hardware-level firmware updates (see Domain 4 articles).</li>
<li>The quarantine process for incoming media (see Domain 18). This article assumes media has already cleared quarantine.</li>
</ul>
<h2 id="3-background">3. Background</h2>
<p>Operating system maintenance is the single most routine and most consequential platform task. It is routine because it happens regularly -- monthly at minimum, often more frequently. It is consequential because a failed update can render a system unbootable, and a missed security patch can leave a known vulnerability open indefinitely.</p>
<p>In internet-connected environments, the community handles much of this burden. Security advisories propagate automatically. Package managers resolve dependencies. Rollback mechanisms are built into update tools. In an air-gapped environment, the operator assumes every one of these responsibilities personally. You are the distribution mirror. You are the advisory aggregation service. You are the dependency resolver. This is the cost of sovereignty, and it must be paid consistently.</p>
<p>The historical record of institutions that deferred maintenance -- whether physical or digital -- is uniformly grim. Deferred maintenance compounds. A missed patch becomes two missed patches becomes a system so far behind that updating it requires a full reinstallation. This article exists to prevent that cascade.</p>
<h3 id="31-the-air-gap-maintenance-paradox">3.1 The Air-Gap Maintenance Paradox</h3>
<p>There is a fundamental tension in maintaining an air-gapped system. The air gap exists to protect the institution from external threats. But operating system updates come from the outside world. Every update is, by definition, a controlled breach of the air gap. The institution must manage this tension explicitly: allowing necessary updates through while maintaining the integrity that the air gap provides.</p>
<p>The resolution is procedural, not technical. The air gap is not breached by the update itself but would be breached by an uncontrolled update process. A controlled, documented, verified update process preserves the spirit of the air gap even as it necessarily crosses the physical boundary.</p>
<h2 id="4-system-model">4. System Model</h2>
<h3 id="41-the-update-pipeline">4.1 The Update Pipeline</h3>
<p>Operating system updates flow through a five-stage pipeline. No stage may be skipped.</p>
<p><strong>Stage 1: Intelligence Gathering.</strong> The operator monitors external sources for information about available updates. This happens outside the air gap, on a separate, non-institutional device. Sources include: the distribution's security advisory mailing list, the distribution's release notes, and relevant security databases (CVE databases, distribution-specific trackers). The operator records which updates are available and which are security-relevant.</p>
<p><strong>Stage 2: Triage and Selection.</strong> Not every available update needs to be applied. The operator evaluates each update against three criteria: Does it fix a security vulnerability that is relevant to our deployment? Does it fix a bug we have encountered or are likely to encounter? Does it provide functionality we need? Updates that meet none of these criteria are deferred. Updates that meet at least one are candidates for the next stages.</p>
<p><strong>Stage 3: Acquisition and Verification.</strong> Selected updates are downloaded on the external device. Their cryptographic signatures are verified against known-good keys. The packages are transferred to physical media -- USB drives or optical media -- following the quarantine procedures defined in Domain 18. Once quarantined media is cleared, the packages are available for testing.</p>
<p><strong>Stage 4: Testing.</strong> Updates are applied to a non-production test system first. This test system must mirror the production configuration as closely as feasible. After applying updates, the operator runs the test suite defined in Section 4.4 of this article. The test system remains in the updated state for a minimum observation period of 48 hours before production deployment is authorized.</p>
<p><strong>Stage 5: Production Deployment.</strong> Updates are applied to production systems one at a time, starting with the least critical system. After each system is updated, the operator runs the production verification checklist defined in Section 4.5. If any verification step fails, the operator halts deployment and initiates rollback procedures.</p>
<h3 id="42-the-security-patch-triage-matrix">4.2 The Security Patch Triage Matrix</h3>
<p>Security patches receive special handling. They are classified by two dimensions: severity and relevance.</p>
<p><strong>Severity</strong> follows the standard CVSS framework, simplified for institutional use:</p>
<ul>
<li><strong>Critical:</strong> Remote code execution, privilege escalation, or data exposure without authentication.</li>
<li><strong>High:</strong> Vulnerabilities that require some precondition (authenticated access, specific configuration) but have severe impact.</li>
<li><strong>Medium:</strong> Vulnerabilities with limited impact or that require unlikely preconditions.</li>
<li><strong>Low:</strong> Theoretical vulnerabilities, information disclosure of non-sensitive data, or denial-of-service against non-critical services.</li>
</ul>
<p><strong>Relevance</strong> is assessed against the institution's actual deployment:</p>
<ul>
<li><strong>Direct:</strong> The vulnerable component is installed and actively used.</li>
<li><strong>Indirect:</strong> The vulnerable component is installed but not actively used, or is a dependency of an active component.</li>
<li><strong>None:</strong> The vulnerable component is not installed.</li>
</ul>
<p>The triage matrix:</p>
<div class="table-wrap"><table><thead><tr><th></th><th>Critical</th><th>High</th><th>Medium</th><th>Low</th></tr></thead><tbody>
<tr><td><strong>Direct</strong></td><td>Apply within 7 days</td><td>Apply within 14 days</td><td>Apply at next maintenance cycle</td><td>Apply at convenience</td></tr>
<tr><td><strong>Indirect</strong></td><td>Apply within 14 days</td><td>Apply at next maintenance cycle</td><td>Apply at convenience</td><td>Defer</td></tr>
<tr><td><strong>None</strong></td><td>No action</td><td>No action</td><td>No action</td><td>No action</td></tr>
</tbody></table></div>
<p>These timelines are targets, not absolutes. The air-gap acquisition process adds latency that internet-connected systems do not face. The timelines begin when the operator becomes aware of the vulnerability, not when the patch is released.</p>
<h3 id="43-kernel-management">4.3 Kernel Management</h3>
<p>The kernel is the most sensitive component of the operating system. A failed kernel update can render a system unbootable. Kernel updates therefore receive additional scrutiny.</p>
<p><strong>Rules for kernel updates:</strong></p>
<ul>
<li>Always keep at least two known-good kernels installed and available at boot time.</li>
<li>Before updating the kernel, verify that the bootloader is configured to fall back to the previous kernel if the new one fails to boot.</li>
<li>Kernel updates are never applied to production systems on the same day they are tested. A minimum 72-hour observation period on the test system is required for kernel updates, compared to 48 hours for other updates.</li>
<li>Kernel major version changes (e.g., 5.x to 6.x) are treated as Tier 2 architectural decisions per GOV-001. They require a written proposal, a 30-day waiting period, and a documented rollback plan.</li>
<li>Kernel configuration changes (recompilation, module changes) follow the same testing pipeline as kernel version updates.</li>
</ul>
<h3 id="44-the-test-suite">4.4 The Test Suite</h3>
<p>After applying updates to the test system, the following checks must pass:</p>
<ol>
<li>The system boots successfully to the expected runlevel or target.</li>
<li>All expected filesystems mount correctly.</li>
<li>All expected network interfaces come up with correct configuration.</li>
<li>All core services start and pass their health checks (see D5-005).</li>
<li>Disk I/O performance is within 10% of baseline measurements.</li>
<li>Memory utilization at idle is within 15% of baseline.</li>
<li>All scheduled cron jobs or systemd timers are intact and correctly configured.</li>
<li>The system log shows no errors or unexpected warnings during boot and initial operation.</li>
<li>A test backup completes successfully and can be restored.</li>
<li>Authentication works correctly for all configured accounts.</li>
</ol>
<p>If any check fails, the update is not cleared for production deployment. The failure is documented, and the operator investigates before proceeding.</p>
<h3 id="45-production-verification-checklist">4.5 Production Verification Checklist</h3>
<p>After applying updates to each production system:</p>
<ol>
<li>All items from the test suite (Section 4.4) are verified.</li>
<li>All production workloads resume correctly.</li>
<li>All inter-system connections are functional (see D5-004 for network verification).</li>
<li>Monitoring dashboards show normal values (see D5-005).</li>
<li>A snapshot or backup of the updated system state is created before proceeding to the next system.</li>
</ol>
<h3 id="46-the-upgrade-decision-framework">4.6 The Upgrade Decision Framework</h3>
<p>Periodically, the institution must decide whether to upgrade to a new major OS release or remain on the current one. This decision is governed by the following framework:</p>
<p><strong>Stay on the current release when:</strong></p>
<ul>
<li>The current release is still receiving security patches.</li>
<li>No hardware support gap has emerged (new hardware requires a newer kernel or driver).</li>
<li>No critical software dependency requires the newer release.</li>
<li>The effort of upgrading exceeds the benefit.</li>
</ul>
<p><strong>Upgrade to the new release when:</strong></p>
<ul>
<li>The current release is approaching end of security support.</li>
<li>Hardware support requires it.</li>
<li>Critical software functionality requires it.</li>
<li>The new release has been available for at least six months and the institution has observed its stability in community reports.</li>
</ul>
<p>Major OS upgrades are Tier 2 architectural decisions per GOV-001. They require planning, documentation, and a full rollback strategy. The rollback strategy for a major upgrade must include the ability to restore from a pre-upgrade backup to a fully functional state.</p>
<h2 id="5-rules-constraints">5. Rules & Constraints</h2>
<ul>
<li><strong>R-D5-002-01:</strong> No operating system update shall be applied to a production system without first being tested on a non-production system.</li>
<li><strong>R-D5-002-02:</strong> All updates must be cryptographically verified before application. Updates that fail signature verification are rejected and reported as a security incident.</li>
<li><strong>R-D5-002-03:</strong> At least two bootable kernels must be available on every production system at all times.</li>
<li><strong>R-D5-002-04:</strong> The operator must conduct intelligence gathering for available updates at least monthly. Security-critical sources must be checked at least bi-weekly.</li>
<li><strong>R-D5-002-05:</strong> Every update applied to a production system must be recorded in the operational log with: date, system affected, packages updated, reason for update, test results, and post-deployment verification results.</li>
<li><strong>R-D5-002-06:</strong> Major OS version upgrades require Tier 2 governance per GOV-001.</li>
<li><strong>R-D5-002-07:</strong> No update shall be applied during a period when rollback capabilities are compromised (e.g., when backups are in progress, when the test system is unavailable, or when the operator will be unavailable for the observation period).</li>
</ul>
<h2 id="6-failure-modes">6. Failure Modes</h2>
<ul>
<li><strong>Update neglect.</strong> The operator stops checking for updates. The system falls months or years behind. Eventually, updating requires a chain of intermediate updates or a full reinstallation. Mitigation: the monthly intelligence gathering requirement (R-D5-002-04) and the operational tempo in OPS-001.</li>
<li><strong>Untested deployment.</strong> Under time pressure, the operator skips the test system and applies updates directly to production. The update breaks something. Rollback is required but may be incomplete. Mitigation: R-D5-002-01 is a hard constraint. No exceptions.</li>
<li><strong>Failed rollback.</strong> An update causes problems, but the rollback mechanism fails -- the previous kernel was not preserved, the backup is corrupt, or the rollback procedure was never tested. Mitigation: R-D5-002-03 (multiple kernels) and the requirement to verify rollback capability before deploying.</li>
<li><strong>Signature verification bypass.</strong> The operator cannot verify a package signature and applies it anyway because it seems urgent. A compromised package enters the institution. Mitigation: R-D5-002-02 is absolute. If a signature cannot be verified, the package is not applied. Period.</li>
<li><strong>Test-production divergence.</strong> The test system drifts from production configuration. Updates pass testing but fail in production because the environments differ. Mitigation: quarterly configuration audits comparing test and production systems (see D5-006).</li>
</ul>
<h2 id="7-recovery-procedures">7. Recovery Procedures</h2>
<p><strong>If an update has rendered a system unbootable:</strong></p>
<ol>
<li>Boot from the previous kernel using the bootloader fallback mechanism.</li>
<li>If the previous kernel boots successfully, remove the problematic update and document the failure.</li>
<li>If no kernel boots, boot from the institution's emergency recovery media (a bootable USB or optical disk maintained per OPS-001, R-OPS-07).</li>
<li>Mount the system's root filesystem from recovery media.</li>
<li>Restore the system from the most recent known-good backup.</li>
<li>Document the incident, including the specific update that caused the failure, the symptoms, and the recovery steps taken.</li>
</ol>
<p><strong>If an update has caused service failures without rendering the system unbootable:</strong></p>
<ol>
<li>Identify the specific update that caused the failure using the operational log and package manager history.</li>
<li>Roll back the specific package to its previous version.</li>
<li>Verify that all services are restored.</li>
<li>Document the incident.</li>
<li>Investigate the root cause before re-attempting the update.</li>
</ol>
<p><strong>If the system has fallen significantly behind on updates:</strong></p>
<ol>
<li>Do not attempt to apply all missed updates at once.</li>
<li>Begin with security-critical patches, prioritized by the triage matrix.</li>
<li>Apply updates in small batches, testing each batch before proceeding.</li>
<li>If the system is more than one major release behind, evaluate whether a clean reinstallation from current media is more practical than incremental updating. This decision is a Tier 3 governance decision.</li>
<li>Document the catch-up plan and its execution.</li>
</ol>
<h2 id="8-evolution-path">8. Evolution Path</h2>
<ul>
<li><strong>Years 0-2:</strong> The update pipeline is being established. Expect to refine the test suite and verification checklists as you discover what matters and what does not. The intelligence gathering process will stabilize as you learn which sources are reliable.</li>
<li><strong>Years 2-5:</strong> The pipeline should be routine. Focus on ensuring the test system stays synchronized with production. Begin accumulating historical data on which types of updates cause problems.</li>
<li><strong>Years 5-15:</strong> You will face your first major OS upgrade decision. The framework in Section 4.6 will be tested. Document the experience thoroughly for future reference.</li>
<li><strong>Years 15-30:</strong> Multiple hardware generations will have passed. The OS may have been replaced entirely. The principles in this article -- test before deploy, verify signatures, maintain rollback capability, document everything -- should survive even if every specific procedure changes.</li>
<li><strong>Years 30-50+:</strong> A successor may be maintaining the system. The update pipeline must be documented well enough that they can follow it without oral instruction. The Commentary Section should contain decades of operational wisdom about what types of updates tend to cause problems and how to handle them.</li>
</ul>
<h2 id="9-commentary-section">9. Commentary Section</h2>
<p><em>This section is reserved for dated entries by current and future operators.</em></p>
<p><strong>2026-02-16 -- Founding Entry:</strong> The most dangerous moment in OS maintenance is not the update itself. It is the moment you convince yourself that "this one is safe" and skip the test system. Every failed production deployment in the history of system administration was preceded by that thought. The pipeline exists because human judgment about update safety is unreliable. Follow the pipeline.</p>
<p>The timelines in the triage matrix will feel slow to anyone accustomed to internet-connected systems where patches are applied within hours of release. Remember that the air gap itself is a significant mitigation for many vulnerability classes. A remote code execution vulnerability is substantially less threatening to a system with no network-reachable attack surface. The timelines reflect this reality. Urgency should be proportional to actual risk, not to the severity score alone.</p>
<h2 id="10-references">10. References</h2>
<ul>
<li>ETH-001 -- Ethical Foundations (Principle 2: Integrity Over Convenience)</li>
<li>CON-001 -- The Founding Mandate (air-gap mandate)</li>
<li>SEC-001 -- Threat Model and Security Philosophy (supply chain threats, Category 3)</li>
<li>OPS-001 -- Operations Philosophy (operational tempo, documentation-first principle)</li>
<li>P-001 -- Platform Philosophy and Architectural Principles</li>
<li>P-002 -- Software Acquisition and Verification</li>
<li>P-003 -- Operating System Selection and Configuration</li>
<li>P-012 -- Platform Evolution and Migration Planning</li>
<li>Domain 18 -- Import & Quarantine (quarantine procedures for incoming media)</li>
<li>Domain 12 -- Disaster Recovery (system restore procedures)</li>
</ul>
<hr/>
<hr/>
<h1 id="d5-003-core-service-configuration-and-hardening">D5-003 -- Core Service Configuration and Hardening</h1>
<p><strong>Document ID:</strong> D5-003 <strong>Domain:</strong> 5 -- Platform & Core Systems <strong>Version:</strong> 1.0.0 <strong>Date:</strong> 2026-02-16 <strong>Status:</strong> Ratified <strong>Depends On:</strong> ETH-001, SEC-001, OPS-001, P-001, P-003, P-004, P-005, D5-002 <strong>Depended Upon By:</strong> D5-004, D5-005, D5-006, all Domain 3 implementation articles, all higher-layer service configurations.</p>
<hr/>
<h2 id="1-purpose-1">1. Purpose</h2>
<p>This article defines the configuration and hardening requirements for every core service the institution operates. A core service is a service that other services depend on, that the operator interacts with during normal operation, or whose failure would degrade the institution's ability to function. Core services are the nervous system of the platform. If they are misconfigured, everything built on top of them is unreliable. If they are unhardened, every vulnerability in the stack above them is amplified.</p>
<p>This article serves three purposes simultaneously. First, it establishes configuration baselines -- the known-good state that each service should be in. Second, it provides hardening checklists -- the specific steps taken to reduce each service's attack surface and increase its resilience. Third, it defines verification procedures -- how to confirm that configurations have not drifted from their baselines over time.</p>
<p>Configuration drift is the silent killer of long-lived systems. A setting is changed during troubleshooting and never reverted. A default value is assumed to be correct and never verified. A hardening step is applied to one system but not another. Over months and years, the actual configuration diverges from the documented configuration until the documentation is fiction. This article exists to prevent that divergence.</p>
<h2 id="2-scope-1">2. Scope</h2>
<p>This article covers the following core services:</p>
<ul>
<li>DNS (internal domain resolution)</li>
<li>NTP (time synchronization)</li>
<li>Syslog / logging infrastructure</li>
<li>Authentication and authorization services</li>
<li>SSH (secure shell for local administration)</li>
<li>Firewall (host-level packet filtering)</li>
<li>Cron / scheduled task management</li>
</ul>
<p>This article does NOT cover:</p>
<ul>
<li>Network-level architecture and segmentation (see D5-004).</li>
<li>Monitoring and alerting systems (see D5-005).</li>
<li>Application-layer services built on top of these core services.</li>
<li>The initial installation and selection of these services (see P-003 and P-004).</li>
</ul>
<h2 id="3-background-1">3. Background</h2>
<p>The concept of "hardening" comes from military fortification: reducing the surface area that an attacker can target. In system administration, hardening means disabling unnecessary features, restricting access to necessary features, and configuring services to fail safely rather than fail open.</p>
<p>Hardening is often treated as a one-time activity: you harden a system when you deploy it and then forget about it. This is insufficient for a fifty-year institution. Hardening must be verified continuously because configurations drift, updates reset settings, and new features enable new attack surfaces. A hardened system that is not regularly verified is a system that was hardened once and may not be hardened now.</p>
<p>For an air-gapped institution, hardening serves a dual purpose. The obvious purpose is security against external threats -- which, given the air gap, are primarily supply-chain attacks and insider threats. The less obvious but equally important purpose is operational reliability. A hardened service is a service with fewer moving parts, fewer enabled features to malfunction, and fewer interactions to produce unexpected behavior. Hardening is simplification, and simplification is survival.</p>
<h3 id="31-the-service-dependency-map">3.1 The Service Dependency Map</h3>
<p>Understanding service dependencies is critical because a failure in one core service can cascade. The dependency map for the institution's core services is:</p>
<pre><code>Authentication &lt;-- SSH &lt;-- Remote Administration
      |
      v
NTP (time sync) &lt;-- Logging (timestamps) &lt;-- All services (audit trail)
      |
      v
DNS (name resolution) &lt;-- All services that resolve names
      |
      v
Firewall (host-level) &lt;-- All network-facing services
      |
      v
Cron (scheduling) &lt;-- Maintenance tasks, log rotation, health checks</code></pre>
<p>A failure in NTP, for example, does not merely mean the clock is wrong. It means log timestamps are unreliable, certificate validation may fail (if timestamps are sufficiently wrong), and any time-based authentication tokens become suspect. Dependencies are multiplicative, not additive.</p>
<h2 id="4-system-model-1">4. System Model</h2>
<h3 id="41-configuration-baselines">4.1 Configuration Baselines</h3>
<p>A configuration baseline is a documented, version-controlled record of every configuration file and every significant setting for a service. The baseline is the "known-good state." Deviations from the baseline must be deliberate, documented, and reviewed.</p>
<p>For each core service, the baseline document must contain:</p>
<ol>
<li><strong>Service identity:</strong> Name, version, purpose within the institution.</li>
<li><strong>Configuration files:</strong> Full path to every configuration file, with a cryptographic hash of the expected contents.</li>
<li><strong>Enabled features:</strong> An explicit list of features that are enabled and why.</li>
<li><strong>Disabled features:</strong> An explicit list of features that were deliberately disabled and why. This is as important as the enabled list, because it records decisions.</li>
<li><strong>Listening interfaces and ports:</strong> Every network port the service listens on, and on which interfaces. If a service should not listen on a network at all, this must be stated.</li>
<li><strong>Permissions:</strong> File permissions on configuration files, binary files, and data directories. User and group ownership.</li>
<li><strong>Resource limits:</strong> Any CPU, memory, or file descriptor limits applied to the service.</li>
<li><strong>Logging configuration:</strong> What the service logs, where it logs, and at what verbosity level.</li>
<li><strong>Dependencies:</strong> What other services this service requires to function.</li>
<li><strong>Startup configuration:</strong> How the service starts (systemd unit, init script, etc.), what happens if it fails to start, and whether it restarts automatically.</li>
</ol>
<h3 id="42-hardening-checklists-by-service">4.2 Hardening Checklists by Service</h3>
<h4 id="421-dns-internal-resolution">4.2.1 DNS (Internal Resolution)</h4>
<p>The institution runs an internal DNS server for name resolution within the air-gapped network. There is no external DNS. There are no upstream forwarders. The DNS server is authoritative for all internal zones and resolves nothing else.</p>
<p>Hardening checklist:</p>
<ul>
<li>Recursion is disabled or restricted to the local network only.</li>
<li>Zone transfers are disabled or restricted to authorized secondary servers only.</li>
<li>The DNS server does not listen on any external-facing interface (there should be none, but verify).</li>
<li>DNSSEC is configured for internal zones if the DNS implementation supports it.</li>
<li>The DNS cache is sized appropriately and cache poisoning mitigations are enabled.</li>
<li>Version information is not disclosed in responses.</li>
<li>The DNS process runs as a dedicated, unprivileged user.</li>
<li>Configuration files are owned by root and readable only by the service user.</li>
<li>Rate limiting is enabled to prevent resource exhaustion from misconfigured clients.</li>
</ul>
<h4 id="422-ntp-time-synchronization">4.2.2 NTP (Time Synchronization)</h4>
<p>In an air-gapped environment, there are no external NTP servers. Time synchronization operates within the internal network. One system is designated as the authoritative time source (the stratum 1 server, synchronized to a local hardware clock or GPS receiver if available), and all other systems synchronize to it.</p>
<p>Hardening checklist:</p>
<ul>
<li>The NTP daemon listens only on internal interfaces.</li>
<li>Authentication is enabled between NTP peers (symmetric key or autokey).</li>
<li>The NTP daemon does not allow monlist or other amplification-prone queries from unauthorized sources.</li>
<li>The stratum 1 server's local clock source is documented, and its drift characteristics are recorded.</li>
<li>NTP clients are configured to reject time steps larger than a defined threshold (e.g., 1000 seconds) without manual confirmation, to prevent accidental or malicious clock jumps.</li>
<li>The NTP process runs as a dedicated, unprivileged user.</li>
<li>If no hardware clock source is available, the institution must document its time accuracy expectations and the implications for time-sensitive operations (log correlation, certificate validity).</li>
</ul>
<h4 id="423-syslog-logging-infrastructure">4.2.3 Syslog / Logging Infrastructure</h4>
<p>Centralized logging is essential for security, troubleshooting, and auditing. All systems forward their logs to a central log server. The log server is a critical service whose integrity must be protected.</p>
<p>Hardening checklist:</p>
<ul>
<li>Log transport between systems is encrypted (TLS-protected syslog).</li>
<li>The central log server accepts logs only from known, authorized systems.</li>
<li>Log files are stored on a dedicated partition or volume to prevent log exhaustion from filling the root filesystem.</li>
<li>Log rotation is configured with retention periods defined by institutional policy.</li>
<li>Logs are append-only at the application level. The log server does not allow remote deletion or modification of logs.</li>
<li>The log server process runs as a dedicated, unprivileged user.</li>
<li>Log files are permission-restricted: writable only by the logging service, readable by authorized administrators.</li>
<li>Log integrity verification is performed regularly (checksums or signed log chains).</li>
<li>The logging infrastructure has its own logging -- a separate mechanism to detect if the primary logging system itself fails.</li>
</ul>
<h4 id="424-authentication-and-authorization">4.2.4 Authentication and Authorization</h4>
<p>The institution's authentication service provides identity verification for all human and service accounts. This may be implemented as a local directory service (e.g., LDAP), a centralized account database, or a carefully managed set of local accounts with synchronized configuration.</p>
<p>Hardening checklist:</p>
<ul>
<li>Accounts follow the principle of least privilege. No user has more access than required for their role.</li>
<li>Service accounts are separate from human accounts and have only the permissions required for their specific function.</li>
<li>Password policies enforce minimum complexity and length. Passphrases are preferred over passwords.</li>
<li>Account lockout or rate-limiting is enabled for failed authentication attempts.</li>
<li>All authentication events (successful and failed) are logged.</li>
<li>Root or superuser access is controlled through sudo or equivalent, with full command logging.</li>
<li>Direct root login is disabled on all services except the local console.</li>
<li>Unused default accounts are disabled or removed.</li>
<li>Authentication credentials are stored using strong, salted hashing (bcrypt, scrypt, or equivalent).</li>
<li>Session timeouts are configured for all interactive services.</li>
</ul>
<h4 id="425-ssh-secure-shell">4.2.5 SSH (Secure Shell)</h4>
<p>SSH is the primary mechanism for remote administration within the internal network.</p>
<p>Hardening checklist:</p>
<ul>
<li>Password authentication is disabled. Key-based authentication only.</li>
<li>Root login via SSH is disabled.</li>
<li>SSH listens only on internal interfaces.</li>
<li>Cipher suites are restricted to strong, current algorithms. Weak ciphers are explicitly disabled.</li>
<li>Idle session timeout is configured. Maximum authentication attempts per connection is limited.</li>
<li>SSH key sizes meet the institutional minimum (RSA 4096-bit or Ed25519).</li>
<li>SSH host keys are inventoried and their fingerprints are documented for verification.</li>
<li>Port forwarding and tunneling are disabled unless explicitly required and documented.</li>
<li>The SSH daemon logs all connection events at a useful verbosity level.</li>
</ul>
<h4 id="426-firewall-host-level">4.2.6 Firewall (Host-Level)</h4>
<p>Every system runs a host-level firewall with a default deny-all policy for both inbound and outbound traffic.</p>
<p>Hardening checklist:</p>
<ul>
<li>Default inbound policy: DROP. Default outbound policy: DROP.</li>
<li>Rules are defined by service, not by port number alone. Each rule is documented with its purpose.</li>
<li>ICMP is permitted for diagnostics but rate-limited. Logging is enabled for dropped packets.</li>
<li>Firewall rules are loaded at boot before any network services start.</li>
<li>The firewall configuration is version-controlled with the configuration baselines.</li>
<li>IPv6 is explicitly disabled if not used, or explicitly firewalled if used.</li>
<li>Anti-spoofing rules are in place. The rule set is reviewed quarterly.</li>
</ul>
<h4 id="427-cron-scheduled-tasks">4.2.7 Cron / Scheduled Tasks</h4>
<p>Cron manages scheduled maintenance tasks, log rotation, health checks, and other periodic operations. Its reliability directly affects institutional maintenance.</p>
<p>Hardening checklist:</p>
<ul>
<li>Access to cron is restricted to authorized users only (cron.allow/cron.deny).</li>
<li>Every cron job is documented in the configuration baseline with its purpose, schedule, and expected runtime.</li>
<li>Cron job output is captured and directed to the logging infrastructure, not to local mailboxes or /dev/null.</li>
<li>Cron jobs run with the minimum necessary privileges.</li>
<li>Resource-intensive cron jobs are scheduled to avoid conflicts with each other and with peak usage periods.</li>
<li>The cron daemon's own health is monitored (see D5-005).</li>
<li>Failed cron jobs generate alerts.</li>
<li>Cron job configurations are version-controlled.</li>
</ul>
<h3 id="43-configuration-drift-detection">4.3 Configuration Drift Detection</h3>
<p>Configuration drift is detected through regular comparison of actual system state against documented baselines. The drift detection procedure runs as follows:</p>
<ol>
<li><strong>Generate current state:</strong> For each core service, extract the current configuration into a comparable format (configuration file hashes, running parameter values, listening ports).</li>
<li><strong>Compare against baseline:</strong> Diff the current state against the documented baseline.</li>
<li><strong>Classify deviations:</strong> Each deviation is classified as:</li>
</ol>
<ul>
<li><strong>Authorized:</strong> A documented, approved change that needs to be incorporated into the baseline.</li>
<li><strong>Unauthorized but benign:</strong> An undocumented change that does not affect security or functionality (e.g., a log file that has grown). The baseline should be updated.</li>
<li><strong>Unauthorized and concerning:</strong> An undocumented change that could affect security or functionality. Investigation is required.</li>
</ul>
<ol>
<li><strong>Remediate:</strong> Authorized deviations update the baseline. Benign deviations update the baseline with a note. Concerning deviations trigger an incident investigation.</li>
<li><strong>Record:</strong> All drift detection results are recorded in the operational log, regardless of whether deviations were found.</li>
</ol>
<p>Drift detection must be performed at least quarterly. It should be performed after any maintenance activity, OS update, or configuration change.</p>
<h2 id="5-rules-constraints-1">5. Rules & Constraints</h2>
<ul>
<li><strong>R-D5-003-01:</strong> Every core service must have a documented configuration baseline before it is placed into production use.</li>
<li><strong>R-D5-003-02:</strong> The hardening checklists in Section 4.2 are mandatory minimums. Additional hardening may be applied but the listed items must not be omitted.</li>
<li><strong>R-D5-003-03:</strong> Configuration drift detection must be performed at least quarterly and after any system change.</li>
<li><strong>R-D5-003-04:</strong> All configuration changes to core services must be documented in the operational log before the change is made (intent) and after the change is verified (result).</li>
<li><strong>R-D5-003-05:</strong> No core service may run as root unless technically required and documented. When root execution is necessary, the justification must be recorded in the configuration baseline.</li>
<li><strong>R-D5-003-06:</strong> The service dependency map must be maintained and updated whenever a new service is added or a dependency changes.</li>
<li><strong>R-D5-003-07:</strong> Configuration files for core services must be stored in version control (see D5-006).</li>
</ul>
<h2 id="6-failure-modes-1">6. Failure Modes</h2>
<ul>
<li><strong>Configuration drift undetected.</strong> Quarterly audits are skipped. The actual configuration diverges from documentation. When a system needs to be rebuilt, the documentation produces a system different from the one that was running. Mitigation: R-D5-003-03 and integration with the operational tempo in OPS-001.</li>
<li><strong>Hardening regression.</strong> A software update resets a hardening setting to its default. The regression is not detected because drift detection did not run after the update. Mitigation: drift detection after every update (D5-002 integration) and explicit post-update verification.</li>
<li><strong>Dependency cascade failure.</strong> A core service fails, and the operator does not understand the dependency chain, causing them to troubleshoot the wrong service. Mitigation: the dependency map in Section 3.1 and its maintenance requirement (R-D5-003-06).</li>
<li><strong>Over-hardening.</strong> A service is hardened so aggressively that it cannot function. Features required by legitimate operations are disabled. Mitigation: testing every hardening change before production deployment, and documenting the rationale for every disabled feature so it can be re-evaluated.</li>
<li><strong>Documentation fiction.</strong> The baselines are documented but never verified. They describe a system that existed once but no longer does. The documentation provides false confidence. Mitigation: drift detection is the cure. Baselines without verification are theories, not facts.</li>
</ul>
<h2 id="7-recovery-procedures-1">7. Recovery Procedures</h2>
<p><strong>If a core service has been misconfigured:</strong></p>
<ol>
<li>Compare the current configuration against the version-controlled baseline.</li>
<li>Identify the specific deviation.</li>
<li>If the baseline is known-good, restore the baseline configuration.</li>
<li>Restart the service.</li>
<li>Verify functionality using the service's health check.</li>
<li>Document the misconfiguration, its cause, and the restoration.</li>
</ol>
<p><strong>If configuration drift has accumulated over a long period:</strong></p>
<ol>
<li>Perform a full drift detection against all core service baselines.</li>
<li>Classify each deviation per Section 4.3.</li>
<li>For concerning deviations, investigate before remediating. The deviation may be hiding a deeper problem.</li>
<li>Remediate in small batches, verifying after each batch.</li>
<li>Update baselines to reflect the verified-good state.</li>
<li>Schedule a follow-up audit within 30 days to confirm stability.</li>
</ol>
<p><strong>If a core service fails and the cause is unknown:</strong></p>
<ol>
<li>Consult the service dependency map. Verify that all dependencies are healthy before investigating the failed service itself.</li>
<li>Check the service's logs for error messages.</li>
<li>Compare the current configuration against the baseline.</li>
<li>If the configuration matches the baseline and dependencies are healthy, the problem is likely a software bug or resource issue. Check resource utilization (disk, memory, CPU).</li>
<li>If the service cannot be restored, restore from the most recent known-good backup and apply changes incrementally until the problem recurs.</li>
</ol>
<h2 id="8-evolution-path-1">8. Evolution Path</h2>
<ul>
<li><strong>Years 0-2:</strong> Establish configuration baselines for all core services. The initial baselines will be refined frequently as operational experience reveals necessary adjustments. Expect the hardening checklists to grow as edge cases are discovered.</li>
<li><strong>Years 2-5:</strong> Baselines should be stable. Drift detection should be routine. The focus shifts to ensuring that updates (D5-002) do not regress hardening settings.</li>
<li><strong>Years 5-15:</strong> Core services may be replaced as better alternatives emerge. When a service is replaced, the new service receives a full baseline and hardening treatment before entering production. The old service's baseline is archived, not deleted.</li>
<li><strong>Years 15-30:</strong> The hardening landscape will have changed. Algorithms considered strong today may be weak. New attack vectors may have emerged. The hardening checklists must be reviewed against current best practices during annual reviews.</li>
<li><strong>Years 30-50+:</strong> The specific services listed in this article may no longer exist. But the principles -- document everything, harden everything, detect drift, maintain the dependency map -- must persist regardless of which specific software implements them.</li>
</ul>
<h2 id="9-commentary-section-1">9. Commentary Section</h2>
<p><em>This section is reserved for dated entries by current and future operators.</em></p>
<p><strong>2026-02-16 -- Founding Entry:</strong> The hardening checklists in this article will feel exhaustive to someone who has never had a system compromised and paranoid to someone who has. They are neither. They are the minimum. Every item in every checklist addresses a real attack vector or a real operational failure that has been documented in the broader system administration community. If an item seems unnecessary, you are fortunate enough not to have encountered the scenario it prevents. Do not confuse that fortune with evidence that the scenario is impossible.</p>
<p>The service dependency map may seem obvious when you first draw it. It will not seem obvious at 3 AM when a service is down and you cannot remember whether NTP failing could possibly affect authentication. Maintain the map. Consult the map. Update the map. It is a tool for your worst moments, not your best ones.</p>
<h2 id="10-references-1">10. References</h2>
<ul>
<li>ETH-001 -- Ethical Foundations (Principle 3: Transparency of Operation)</li>
<li>SEC-001 -- Threat Model and Security Philosophy (Pillar 2: Security Is a Property)</li>
<li>OPS-001 -- Operations Philosophy (documentation-first principle)</li>
<li>P-001 -- Platform Philosophy and Architectural Principles</li>
<li>P-003 -- Operating System Selection and Configuration</li>
<li>P-004 -- Network Services Architecture</li>
<li>P-005 -- Identity and Access Management</li>
<li>D5-002 -- Operating System Maintenance Procedures (update-triggered drift detection)</li>
<li>D5-004 -- Network Architecture and Segmentation (network-level hardening context)</li>
<li>D5-005 -- System Monitoring and Alerting (health check integration)</li>
<li>D5-006 -- Configuration Management Without Internet (version control for configs)</li>
<li>Domain 3 -- Security & Integrity (security requirements these configurations implement)</li>
</ul>
<hr/>
<hr/>
<h1 id="d5-004-network-architecture-and-segmentation">D5-004 -- Network Architecture and Segmentation</h1>
<p><strong>Document ID:</strong> D5-004 <strong>Domain:</strong> 5 -- Platform & Core Systems <strong>Version:</strong> 1.0.0 <strong>Date:</strong> 2026-02-16 <strong>Status:</strong> Ratified <strong>Depends On:</strong> ETH-001, CON-001, SEC-001, OPS-001, P-001, P-004, D5-003 <strong>Depended Upon By:</strong> D5-005, D5-006, all Domain 3 network security articles, all higher-layer service deployments.</p>
<hr/>
<h2 id="1-purpose-2">1. Purpose</h2>
<p>This article defines the internal network architecture of the institution. It specifies how systems are connected, how network traffic is segmented and controlled, what "air-gapped" means at every level of the network, and how the network is monitored for anomalies.</p>
<p>The word "air-gapped" is used frequently in this institution's documentation. Most people understand it as "not connected to the internet." That understanding is incomplete. A properly air-gapped network is not merely disconnected from the internet -- it is designed so that reconnection is physically difficult, so that the absence of external connectivity is a structural property rather than a configuration option. This article defines what that structural property looks like in practice, including every exception, every boundary, and every physical enforcement mechanism.</p>
<p>Additionally, this article defines the internal segmentation of the network. Even though all systems are behind the air gap, not all systems should be able to communicate with all other systems freely. Internal segmentation limits the blast radius of any compromise, contains misconfigurations, and enforces the principle of least privilege at the network level. A flat internal network is a convenience that becomes a liability the moment anything goes wrong.</p>
<h2 id="2-scope-2">2. Scope</h2>
<p>This article covers:</p>
<ul>
<li>The physical network topology of the institution.</li>
<li>The logical network topology, including VLANs and subnets.</li>
<li>Firewall rules between network segments.</li>
<li>The definition and enforcement of the air gap.</li>
<li>Every authorized exception to the air gap and how those exceptions are controlled.</li>
<li>Network monitoring procedures.</li>
<li>Physical versus logical segmentation and when each is used.</li>
<li>Inter-system communication policies.</li>
</ul>
<p>This article does NOT cover:</p>
<ul>
<li>The configuration of individual services on the network (see D5-003).</li>
<li>The physical cabling and hardware specifications (see Domain 4).</li>
<li>Wireless networking (there is none; see Section 4.2).</li>
<li>External communication of any kind (there is none; the absence is the point).</li>
</ul>
<h2 id="3-background-2">3. Background</h2>
<p>Network architecture is the skeleton of any digital institution. It determines which systems can talk to which other systems, what traffic is visible to whom, and how failures in one part of the network affect other parts. In an internet-connected environment, network architecture must defend against external attackers, internal compromises, lateral movement, data exfiltration, and dozens of other threats. In an air-gapped environment, many of these threats are eliminated, but they are replaced by a different set of requirements.</p>
<p>The primary network threat in an air-gapped institution is not external penetration. It is internal misconfiguration. A wrong firewall rule that blocks a critical service. A VLAN misconfiguration that allows a test system to access production data. A network change that subtly breaks monitoring. These are the failures that air-gapped institutions face, and they are addressed through careful design, documentation, and verification rather than through complex intrusion detection systems.</p>
<h3 id="31-why-segment-an-air-gapped-network">3.1 Why Segment an Air-Gapped Network?</h3>
<p>A common question: if the network is air-gapped, why bother with internal segmentation? The answer has three parts.</p>
<p>First, defense in depth. The air gap is one layer of protection. Internal segmentation is another. If the air gap is somehow compromised -- through a supply-chain attack on imported media, through a malicious device introduced during maintenance, or through a mistake -- internal segmentation limits the attacker's ability to move laterally.</p>
<p>Second, operational hygiene. Segmentation prevents operational accidents. A misconfigured service in the test segment cannot accidentally corrupt production data if the segments are properly isolated. A script running in the development environment cannot inadvertently access the backup server. Segmentation is as much about preventing mistakes as preventing attacks.</p>
<p>Third, monitoring clarity. In a flat network, all traffic looks the same. In a segmented network, traffic between segments is visible and auditable. A packet crossing from the test segment to the production segment is an event worth investigating. In a flat network, you would not even notice it.</p>
<h2 id="4-system-model-2">4. System Model</h2>
<h3 id="41-physical-network-topology">4.1 Physical Network Topology</h3>
<p>The institution's physical network uses wired Ethernet exclusively. Every connection between systems is a physical cable. There are no wireless access points, no Bluetooth adapters, no infrared ports. Wireless capability is a physical air-gap violation because it creates a communication channel that cannot be controlled by cable management alone.</p>
<p>The physical topology is a modified star: all systems connect to one or more managed switches, which connect to a central router or firewall appliance that enforces segmentation rules. The specific hardware is documented in Domain 4. This article addresses the logical design that runs on that hardware.</p>
<p><strong>Physical enforcement of the air gap:</strong></p>
<ul>
<li>No system in the institution has a network interface connected to any network outside the institution. This is not a software configuration. It is a physical absence: there is no cable, no port, no antenna.</li>
<li>Network interfaces that are not in use are physically disabled. On systems where this is possible at the hardware level (BIOS/UEFI disabling, physical disconnection), hardware-level disabling is used. Software-level disabling is a secondary measure, not a primary one.</li>
<li>The institution's network switches do not have uplink ports connected to any external network.</li>
<li>There is no modem, no cellular adapter, no satellite link. The absence of these devices is verified during the annual security audit.</li>
</ul>
<h3 id="42-wireless-policy">4.2 Wireless Policy</h3>
<p>There is no wireless networking. WiFi capabilities are disabled at the BIOS/UEFI level where possible and via kernel module blacklisting as a secondary measure. Bluetooth is disabled at the hardware and software level on all systems. Any device entering the institution that has wireless capability must have that capability physically disabled or used under Domain 18 quarantine procedures.</p>
<p>Wireless signals cross air gaps. A WiFi-enabled device inside the air-gapped network is a potential bridge to any wireless network within range. The air gap requires the absence of wireless, not merely the disabling of it at the software level.</p>
<h3 id="43-logical-network-segmentation">4.3 Logical Network Segmentation</h3>
<p>The internal network is divided into segments using VLANs (Virtual Local Area Networks). Each segment serves a specific function and has defined rules for what traffic may enter and leave it.</p>
<p><strong>Segment 1: Core Services (VLAN 10)</strong> Purpose: Hosts the institution's core infrastructure services -- DNS, NTP, authentication, central logging. Access policy: All other segments may send requests to Core Services on defined ports. Core Services may respond. Core Services may not initiate connections to other segments except for specific, documented purposes (e.g., the log server initiating a pull from a system that supports pull-based logging). Systems in this segment: DNS server, NTP server, authentication server, central log server.</p>
<p><strong>Segment 2: Production Systems (VLAN 20)</strong> Purpose: Hosts the institution's primary operational systems -- the systems that store and process institutional data. Access policy: Production systems may access Core Services. Production systems may access the Backup segment for backup operations. Production systems may not access the Test segment or the Administration segment directly. Systems in this segment: Primary storage servers, database servers, application servers.</p>
<p><strong>Segment 3: Backup and Archive (VLAN 30)</strong> Purpose: Hosts backup servers and archive storage. Access policy: Production systems may push data to the Backup segment. The Backup segment may pull data from Production. The Backup segment may not access any other segment. The Backup segment has no path to the Test segment or the Administration segment. Systems in this segment: Backup servers, archive storage, tape libraries (if applicable).</p>
<p><strong>Segment 4: Test and Development (VLAN 40)</strong> Purpose: Hosts test systems, development environments, and the OS update test system (per D5-002). Access policy: The Test segment may access Core Services for basic infrastructure (DNS, NTP, authentication). The Test segment may not access Production or Backup. Traffic from the Test segment to Production is explicitly blocked. Systems in this segment: Test mirrors of production systems, development workstations, update testing systems.</p>
<p><strong>Segment 5: Administration (VLAN 50)</strong> Purpose: The operator's primary workstation and administrative tools. This is the segment from which the operator manages all other segments. Access policy: The Administration segment may access all other segments via SSH and defined management ports. No other segment may initiate connections to the Administration segment. This is the most privileged segment. Systems in this segment: The operator's administrative workstation, monitoring dashboards, configuration management tools.</p>
<p><strong>Segment 6: Quarantine (VLAN 60)</strong> Purpose: Isolated segment for processing incoming media and data per Domain 18. Access policy: The Quarantine segment has no access to any other segment. Data leaves Quarantine only through a defined, manual transfer process (sneakernet) after clearing quarantine procedures. The Quarantine segment may have its own isolated Core Services (local DNS, NTP) or may function without them entirely. Systems in this segment: Quarantine workstation, malware scanning systems.</p>
<h3 id="44-firewall-rules-architecture">4.4 Firewall Rules Architecture</h3>
<p>Firewall rules implement the access policies defined in Section 4.3. Rules are maintained at two levels:</p>
<p><strong>Network-level (perimeter) firewall:</strong> Implemented on the central router or firewall appliance. Controls inter-VLAN traffic. Default policy: deny all inter-VLAN traffic. Explicit rules permit only the traffic described in the segment access policies above.</p>
<p><strong>Host-level firewall:</strong> Implemented on every individual system per D5-003, Section 4.2.6. Provides defense in depth. Even if the network-level firewall is misconfigured, the host-level firewall provides an additional layer of protection.</p>
<p>The firewall rule set is documented in a dedicated firewall rules document that is version-controlled alongside configuration baselines (D5-006). Every rule has:</p>
<ul>
<li>A unique identifier.</li>
<li>Source segment and/or IP range.</li>
<li>Destination segment and/or IP range.</li>
<li>Protocol and port.</li>
<li>Direction (inbound/outbound relative to the segment).</li>
<li>Purpose: a human-readable explanation of why this rule exists.</li>
<li>Date added and authorization reference (operational log entry or governance decision).</li>
</ul>
<p>Rules without documented purposes are treated as unauthorized configurations and are removed.</p>
<h3 id="45-the-air-gap-exception-register">4.5 The Air-Gap Exception Register</h3>
<p>The air gap is absolute during normal operations. However, there are specific, controlled scenarios where the boundary between the institution and the outside world is crossed. These are not breaches of the air gap. They are controlled crossings, and they are enumerated here because an unenumerated crossing is, by definition, unauthorized.</p>
<p><strong>Exception 1: Software and Update Import.</strong> Media enters the institution carrying software updates, operating system patches, or new software packages. This crossing is governed by Domain 18 (Import & Quarantine) and D5-002 (OS Maintenance). The media never connects to an institutional network. It connects only to the Quarantine segment, which has no connectivity to other segments.</p>
<p><strong>Exception 2: Data Import.</strong> External data (documents, reference materials, archives) enters the institution through the same quarantine process. Again, media connects only to the Quarantine segment.</p>
<p><strong>Exception 3: Data Export.</strong> Institutional data may occasionally need to leave the institution (e.g., off-site backup rotation). Data export follows a defined procedure: data is written to media on a system in the Backup segment, the media is physically removed, and its removal is logged. The system that wrote the media has no external connectivity at any point during this process.</p>
<p><strong>Exception 4: Hardware Maintenance.</strong> Hardware leaving the institution undergoes data destruction per Domain 3. Hardware entering undergoes quarantine per Domain 18.</p>
<p>There are no other exceptions. Any new crossing type must be added to this register through a Tier 2 governance decision per GOV-001 before the crossing occurs.</p>
<h3 id="46-network-monitoring">4.6 Network Monitoring</h3>
<p>Network monitoring in an air-gapped institution serves different purposes than in an internet-connected one. There is no intrusion detection for external attacks because there is no external attack surface. Instead, network monitoring focuses on:</p>
<ul>
<li><strong>Traffic pattern verification:</strong> Is traffic flowing between authorized segments only? Is any traffic appearing on segments where it should not?</li>
<li><strong>Bandwidth baseline monitoring:</strong> Is traffic volume consistent with expected patterns? A sudden spike could indicate a misconfiguration or a compromised system generating unusual traffic.</li>
<li><strong>Service availability:</strong> Are the expected services on each segment reachable and responding?</li>
<li><strong>ARP table monitoring:</strong> Are the MAC addresses on each segment consistent with the known hardware inventory? An unexpected MAC address is a physical security concern.</li>
<li><strong>VLAN integrity:</strong> Are VLAN tags being respected? Is any traffic leaking between VLANs outside the firewall?</li>
</ul>
<p>Network monitoring data is forwarded to the central log server in the Core Services segment and reviewed as part of the daily health check (D5-005).</p>
<h2 id="5-rules-constraints-2">5. Rules & Constraints</h2>
<ul>
<li><strong>R-D5-004-01:</strong> The air gap is enforced physically, not merely logically. No institutional system may possess an active network interface connected to any non-institutional network.</li>
<li><strong>R-D5-004-02:</strong> All wireless networking capabilities must be disabled at the hardware level on all institutional systems.</li>
<li><strong>R-D5-004-03:</strong> Inter-VLAN traffic is denied by default. Only explicitly documented and authorized rules permit traffic between segments.</li>
<li><strong>R-D5-004-04:</strong> Every firewall rule must have a documented purpose. Rules without documented purposes are unauthorized.</li>
<li><strong>R-D5-004-05:</strong> The Air-Gap Exception Register (Section 4.5) is the complete and authoritative list of authorized boundary crossings. Any crossing not on the register is a security incident.</li>
<li><strong>R-D5-004-06:</strong> The Quarantine segment must have no network connectivity to any other institutional segment.</li>
<li><strong>R-D5-004-07:</strong> Network architecture changes are Tier 2 governance decisions per GOV-001.</li>
<li><strong>R-D5-004-08:</strong> The network topology, VLAN assignments, and firewall rules must be reviewed at least annually and after any network change.</li>
</ul>
<h2 id="6-failure-modes-2">6. Failure Modes</h2>
<ul>
<li><strong>VLAN misconfiguration.</strong> A VLAN assignment error allows a system in one segment to access another segment's traffic. This can result in data leakage or unauthorized access. Mitigation: verify VLAN assignments after every network change. Test by attempting cross-segment access from each segment and confirming it is blocked where it should be.</li>
<li><strong>Firewall rule creep.</strong> Over time, temporary rules are added and never removed. The firewall becomes permissive by accumulation. Mitigation: annual firewall rule review. Every rule must be re-justified or removed.</li>
<li><strong>Air-gap drift.</strong> A wireless adapter is installed during a hardware replacement and not disabled. A modem is connected for "temporary" external access and never removed. Mitigation: the annual physical audit verifies the absence of unauthorized communication paths.</li>
<li><strong>Switch failure.</strong> A managed switch fails, disrupting multiple segments. Mitigation: spare switches in inventory. Documented switch configuration that can be applied to a replacement within hours.</li>
<li><strong>Monitoring blind spot.</strong> A segment is not monitored, allowing anomalies to go undetected. Mitigation: the monitoring configuration must cover all segments. The monitoring system's own coverage is verified during quarterly reviews (D5-005).</li>
<li><strong>Quarantine bypass.</strong> Media is connected directly to a non-quarantine system, bypassing the quarantine process. Mitigation: physical and procedural controls. USB ports on non-quarantine systems may be physically disabled or access-controlled.</li>
</ul>
<h2 id="7-recovery-procedures-2">7. Recovery Procedures</h2>
<p><strong>If a VLAN misconfiguration is discovered:</strong></p>
<ol>
<li>Immediately correct the VLAN assignment on the affected switch port.</li>
<li>Review traffic logs to determine whether unauthorized traffic crossed segment boundaries during the misconfiguration.</li>
<li>If unauthorized traffic occurred, treat this as a security incident per SEC-001.</li>
<li>Document the misconfiguration, its duration, its impact assessment, and the correction.</li>
</ol>
<p><strong>If a firewall rule is found to be overly permissive:</strong></p>
<ol>
<li>Tighten the rule immediately to the minimum required permission.</li>
<li>Review logs for any traffic that exploited the permissive rule.</li>
<li>Update the firewall rule documentation.</li>
<li>Conduct a full firewall rule review to check for similar issues.</li>
</ol>
<p><strong>If an unauthorized communication path is discovered (air-gap violation):</strong></p>
<ol>
<li>Physically disconnect the unauthorized path immediately.</li>
<li>Treat this as a security incident. Assume all systems reachable through the unauthorized path may be compromised.</li>
<li>Conduct a full forensic review of affected systems per SEC-001.</li>
<li>Document the violation, the response, and the remediation.</li>
<li>Implement physical controls to prevent recurrence.</li>
</ol>
<p><strong>If network connectivity is lost between segments:</strong></p>
<ol>
<li>Check physical connectivity: cables, switch ports, switch power.</li>
<li>Check switch configuration: VLAN assignments, port status.</li>
<li>Check the central firewall: rule set, interface status.</li>
<li>If hardware has failed, replace with spare hardware and apply the documented configuration from version control.</li>
<li>Verify full connectivity using the network verification checklist.</li>
<li>Document the outage, its cause, its duration, and the resolution.</li>
</ol>
<h2 id="8-evolution-path-2">8. Evolution Path</h2>
<ul>
<li><strong>Years 0-2:</strong> The network is being built for the first time. Expect VLAN assignments and firewall rules to be revised frequently as services are deployed and operational requirements become clear. Document every change. The initial rule set will be the foundation for all future changes.</li>
<li><strong>Years 2-5:</strong> The network architecture should be stable. Changes should be infrequent and governed by Tier 2 decisions. The focus shifts to monitoring and verification: confirming that the network still matches its documentation.</li>
<li><strong>Years 5-15:</strong> Network hardware will need replacement. When replacing switches or the firewall appliance, the documented configuration is applied to the new hardware and verified. This is the first real test of whether the documentation is sufficient.</li>
<li><strong>Years 15-30:</strong> Networking technology may have evolved significantly. New standards, new hardware capabilities, new segmentation mechanisms. The principles in this article -- segment by function, deny by default, enforce physically, document everything -- must guide the adoption of new technology.</li>
<li><strong>Years 30-50+:</strong> The physical network may look nothing like what exists today. But the logical architecture -- separate segments for separate functions, controlled boundaries between them, physical enforcement of the air gap -- should be recognizable. Technology changes. Architecture principles endure.</li>
</ul>
<h2 id="9-commentary-section-2">9. Commentary Section</h2>
<p><em>This section is reserved for dated entries by current and future operators.</em></p>
<p><strong>2026-02-16 -- Founding Entry:</strong> The Quarantine segment deserves special attention. It is tempting to give it "read-only" access to some internal service -- maybe DNS, for convenience during quarantine operations. Resist this temptation. The Quarantine segment is where untrusted data enters the institution. Any network path from Quarantine to other segments is a path that compromised data could travel. If the Quarantine workstation needs DNS, give it a local hosts file. If it needs time synchronization, set the clock manually. Inconvenience in the Quarantine segment is a feature, not a bug.</p>
<p>The six-segment architecture described here may seem elaborate for a small institution. It is. But segments are cheap. They cost nothing once the managed switch is in place. What they provide -- isolation, monitoring clarity, blast radius containment -- is worth far more than the modest effort of maintaining VLAN assignments. Do not be tempted to collapse segments "for simplicity." Flat networks are simple in the way that unlocked doors are simple: the simplicity saves effort until the moment it costs everything.</p>
<h2 id="10-references-2">10. References</h2>
<ul>
<li>ETH-001 -- Ethical Foundations (Principle 1: Sovereignty of the Individual)</li>
<li>CON-001 -- The Founding Mandate (air-gap mandate, Section 3.3)</li>
<li>SEC-001 -- Threat Model and Security Philosophy (trust model, physical threats)</li>
<li>OPS-001 -- Operations Philosophy (operational tempo, maintenance routines)</li>
<li>P-001 -- Platform Philosophy and Architectural Principles</li>
<li>P-004 -- Network Services Architecture</li>
<li>D5-003 -- Core Service Configuration and Hardening (host-level firewall, service hardening)</li>
<li>D5-005 -- System Monitoring and Alerting (network monitoring integration)</li>
<li>Domain 4 -- Infrastructure & Power (physical network hardware)</li>
<li>Domain 18 -- Import & Quarantine (quarantine procedures)</li>
</ul>
<hr/>
<hr/>
<h1 id="d5-005-system-monitoring-and-alerting">D5-005 -- System Monitoring and Alerting</h1>
<p><strong>Document ID:</strong> D5-005 <strong>Domain:</strong> 5 -- Platform & Core Systems <strong>Version:</strong> 1.0.0 <strong>Date:</strong> 2026-02-16 <strong>Status:</strong> Ratified <strong>Depends On:</strong> ETH-001, OPS-001, P-001, P-008, D5-003, D5-004 <strong>Depended Upon By:</strong> D5-006, all Domain 10 daily operations articles, all Domain 12 disaster recovery trigger articles.</p>
<hr/>
<h2 id="1-purpose-3">1. Purpose</h2>
<p>This article defines what the institution monitors, how it monitors, what thresholds trigger alerts, and what the operator does with monitoring data. Monitoring is how the institution knows it is alive. Without monitoring, the operator is blind -- unable to distinguish a healthy system from one that is silently failing.</p>
<p>The distinction between monitoring and alerting is important. Monitoring is the continuous observation of system state. Alerting is the notification that a monitored value has crossed a threshold that requires attention. Monitoring without alerting produces data that nobody looks at. Alerting without monitoring produces noise that cannot be investigated. Both must exist and both must be calibrated.</p>
<p>In an air-gapped institution, monitoring has a particular character. There are no external monitoring services to call home to. There is no cloud dashboard. There are no pager integrations. The monitoring system runs entirely within the institution, and alerts are delivered to the operator through mechanisms that exist within the institution. This means the operator must be physically present or following a defined schedule to receive alerts. Monitoring is useful only if someone is looking.</p>
<p>This article also defines the daily health check -- the specific, step-by-step procedure the operator follows every day to verify that the institution is functioning normally. The daily health check is not optional. It is the first and most important line of defense against silent failures.</p>
<h2 id="2-scope-3">2. Scope</h2>
<p>This article covers:</p>
<ul>
<li>What metrics and log data are monitored across all institutional systems.</li>
<li>How monitoring data is collected, stored, and retained.</li>
<li>Alert thresholds for each monitored metric.</li>
<li>Alert classification (critical, warning, informational).</li>
<li>Dashboard design for the operator.</li>
<li>The daily health check procedure.</li>
<li>What "normal" looks like -- baseline definitions for all monitored values.</li>
<li>Log aggregation for offline systems.</li>
</ul>
<p>This article does NOT cover:</p>
<ul>
<li>The configuration of individual services that produce log data (see D5-003).</li>
<li>Network-level monitoring architecture (see D5-004, Section 4.6; this article covers the consumption of that data).</li>
<li>The response to specific types of incidents (see SEC-001 and Domain 12 for incident response and disaster recovery).</li>
<li>Physical environment monitoring -- temperature, humidity, power (see Domain 4).</li>
</ul>
<h2 id="3-background-3">3. Background</h2>
<p>Monitoring is the institutional sense of sight. A system without monitoring is a system operating in the dark. The operator may believe everything is fine because nothing has obviously failed, but "nothing has obviously failed" is not the same as "everything is working correctly." Disks fill silently. Memory leaks develop over weeks. Certificate expiration dates approach. Backup jobs fail and nobody notices because the failure generates a log entry that nobody reads.</p>
<p>The history of system failures is largely a history of monitoring failures. Not failures of the monitoring system itself, but failures of attention -- monitoring data that was collected but not reviewed, alerts that were generated but not investigated, dashboards that existed but were not consulted. This article addresses all three: what to collect, what to alert on, and what to look at.</p>
<h3 id="31-monitoring-in-an-air-gapped-environment">3.1 Monitoring in an Air-Gapped Environment</h3>
<p>An air-gapped institution has no cloud dashboards, no mobile alerts, no automated remediation. This is a simplification. The monitoring system needs to do exactly four things: collect data from all systems, store data reliably, present data clearly, and alert when something is wrong. It serves one person -- the operator -- and must be simple enough to understand, maintain, and trust.</p>
<h2 id="4-system-model-3">4. System Model</h2>
<h3 id="41-what-to-monitor">4.1 What to Monitor</h3>
<p>Every institutional system is monitored across four categories:</p>
<p><strong>Category 1: Resource Utilization</strong></p>
<ul>
<li>CPU usage: overall percentage, per-core breakdown, load average (1, 5, 15 minute).</li>
<li>Memory: total, used, available, swap usage.</li>
<li>Disk: usage percentage per mount point, I/O rates, I/O latency.</li>
<li>Network: bandwidth in/out per interface, packet error rates, packet drop rates.</li>
</ul>
<p><strong>Category 2: Service Health</strong></p>
<ul>
<li>Service status: running, stopped, failed, for every core service defined in D5-003.</li>
<li>Service responsiveness: time to respond to a health check probe.</li>
<li>Service-specific metrics: DNS query rate and resolution time, NTP offset, authentication success/failure rates, log ingestion rate.</li>
</ul>
<p><strong>Category 3: Security Indicators</strong></p>
<ul>
<li>Authentication failures: count per time period, source, account.</li>
<li>Firewall drops: count per time period, source/destination.</li>
<li>File integrity: changes to critical system files (see D5-003 configuration baselines).</li>
<li>Privileged operations: sudo usage, root logins, service account activity.</li>
</ul>
<p><strong>Category 4: System Integrity</strong></p>
<ul>
<li>SMART data from all disks: reallocated sectors, pending sectors, temperature, power-on hours.</li>
<li>Filesystem integrity: results of periodic fsck or equivalent.</li>
<li>Backup status: last successful backup time, backup size, verification result.</li>
<li>Time synchronization: NTP offset and jitter from the authoritative source.</li>
<li>Certificate expiration dates for any internal TLS certificates.</li>
</ul>
<h3 id="42-how-to-monitor">4.2 How to Monitor</h3>
<p>Monitoring data is collected through a three-layer system:</p>
<p><strong>Layer 1: Agent-based collection.</strong> A lightweight monitoring agent runs on every system. The agent collects resource utilization metrics, service health status, and security indicators at configurable intervals (default: 60 seconds for resource metrics, 300 seconds for service health). The agent pushes data to the central monitoring server in the Core Services segment (VLAN 10).</p>
<p><strong>Layer 2: Log aggregation.</strong> System logs and application logs are forwarded to the central log server via the logging infrastructure described in D5-003. The monitoring system reads from the log server to identify log-based alerts (error messages, authentication failures, etc.).</p>
<p><strong>Layer 3: Active probing.</strong> The monitoring server actively probes services at defined intervals to verify they are responsive. This is distinct from agent-reported status: the agent says "I think the service is running," while the probe verifies "I can actually reach the service and get a correct response."</p>
<p>Monitoring data is stored on the central monitoring server. Retention: high-resolution (60-second intervals) for 7 days, medium-resolution (5-minute averages) for 90 days, low-resolution (1-hour averages) for 2 years, alert history indefinitely. Data older than its retention period is archived (not deleted) during the first five years; the policy may be revised thereafter based on storage constraints.</p>
<h3 id="43-alert-thresholds-and-classification">4.3 Alert Thresholds and Classification</h3>
<p>Alerts are classified into three levels:</p>
<p><strong>Critical:</strong> Requires immediate attention. The system is degraded or at risk of imminent failure. The operator should investigate within one hour of the next scheduled check, or immediately if present.</p>
<p><strong>Warning:</strong> Requires attention at the next maintenance window. The system is functional but trending toward a problem. The operator should investigate within 24 hours.</p>
<p><strong>Informational:</strong> No action required. Recorded for trend analysis and audit purposes. Reviewed during weekly operations.</p>
<p>Default alert thresholds (these are starting values; operational experience will refine them):</p>
<div class="table-wrap"><table><thead><tr><th>Metric</th><th>Warning</th><th>Critical</th></tr></thead><tbody>
<tr><td>CPU load average (15 min)</td><td>> 80% of core count</td><td>> 95% of core count</td></tr>
<tr><td>Memory usage</td><td>> 80%</td><td>> 95%</td></tr>
<tr><td>Swap usage</td><td>> 20%</td><td>> 50%</td></tr>
<tr><td>Disk usage (any mount)</td><td>> 75%</td><td>> 90%</td></tr>
<tr><td>Disk I/O latency</td><td>> 50ms average</td><td>> 200ms average</td></tr>
<tr><td>NTP offset</td><td>> 100ms</td><td>> 1 second</td></tr>
<tr><td>Service health check failure</td><td>1 consecutive failure</td><td>3 consecutive failures</td></tr>
<tr><td>Authentication failures</td><td>> 5 in 10 minutes</td><td>> 20 in 10 minutes</td></tr>
<tr><td>SMART reallocated sectors</td><td>Any non-zero increase</td><td>> 10 increase in 30 days</td></tr>
<tr><td>Backup age</td><td>> 36 hours since last success</td><td>> 72 hours since last success</td></tr>
<tr><td>Certificate expiration</td><td>< 30 days</td><td>< 7 days</td></tr>
<tr><td>Disk error rate (read/write)</td><td>Any non-zero</td><td>> 10 per hour</td></tr>
<tr><td>Firewall drops (unexpected)</td><td>> 100 per hour from single source</td><td>> 1000 per hour from single source</td></tr>
</tbody></table></div>
<p>These thresholds must be calibrated against actual baselines. A system that normally runs at 70% CPU should have different thresholds than one that normally runs at 10%. Baseline calibration is part of the initial deployment process and is recalibrated quarterly.</p>
<h3 id="44-dashboard-design">4.4 Dashboard Design</h3>
<p>The monitoring dashboard is the operator's primary interface to the institution's health. It must be designed for rapid comprehension -- the operator should be able to assess overall health in under 30 seconds.</p>
<p>The dashboard is organized in three tiers:</p>
<p><strong>Tier 1: Overview (the "traffic light" view).</strong> One line per system. Each system shows: name, segment, overall status (green/yellow/red). Green means all monitored values are within normal range. Yellow means at least one warning-level alert is active. Red means at least one critical alert is active. This view answers the question: "Is everything OK?" in under ten seconds.</p>
<p><strong>Tier 2: System detail.</strong> Selected by clicking or navigating from the overview. Shows all monitored metrics for a single system, with current values, 24-hour trend graphs, and active alerts. This view answers the question: "What is wrong with this system?"</p>
<p><strong>Tier 3: Metric detail.</strong> Selected from the system detail view. Shows the full history of a single metric with configurable time range, threshold lines, and annotations for maintenance events. This view answers the question: "How has this metric behaved over time?"</p>
<p>The dashboard must be accessible from the Administration segment (VLAN 50). It should be usable from a text-based terminal if the graphical interface is unavailable. The monitoring system must not require an external browser or framework that complicates the institutional stack.</p>
<h3 id="45-the-daily-health-check-procedure">4.5 The Daily Health Check Procedure</h3>
<p>This is the most important procedure in this article. It is performed every day, takes 15-30 minutes, and is the operator's primary mechanism for detecting problems early. The procedure is performed from the operator's workstation in the Administration segment.</p>
<p><strong>Step 1: Dashboard Review (5 minutes).</strong> Open the monitoring dashboard. Review the Tier 1 overview. Confirm that all systems show green. If any system shows yellow or red, note the system and proceed to Step 2 with that system as a priority.</p>
<p><strong>Step 2: Alert Review (5 minutes).</strong> Review all alerts generated since the last daily check. For each alert:</p>
<ul>
<li>If it is a critical alert that has not been resolved, investigate immediately after completing the daily check.</li>
<li>If it is a warning alert, note it for investigation during this check or the next maintenance window.</li>
<li>If it is informational, note any unusual patterns.</li>
</ul>
<p><strong>Step 3: Log Scan (5 minutes).</strong> Review the last 24 hours of centralized logs for error-level messages. You are not reading every log line. You are scanning for patterns: repeated errors, new error types, errors from systems that do not normally produce errors. The log aggregation system should provide a summary view of error counts by system and by message type.</p>
<p><strong>Step 4: Resource Trend Review (3 minutes).</strong> Check 7-day trends for disk usage across all systems. Disks are the most common resource to silently exhaust. Confirm that no disk is on a trajectory to hit 90% within the next 30 days at the current growth rate. Check memory trends for any system showing a consistent upward trend that could indicate a memory leak.</p>
<p><strong>Step 5: Backup Verification (2 minutes).</strong> Confirm that the most recent backup job for every production system completed successfully. Check the backup age metric. If any backup is older than expected, note it for investigation.</p>
<p><strong>Step 6: Time Synchronization (1 minute).</strong> Verify that all systems show NTP offsets within the acceptable range. Time drift affects log correlation, certificate validation, and scheduled task accuracy.</p>
<p><strong>Step 7: Record (2 minutes).</strong> Record the daily check results in the operational log. If everything is normal, the entry may be brief: "Daily check completed. All systems nominal. No active alerts." If anomalies were found, record them with the planned response.</p>
<h3 id="46-what-normal-looks-like">4.6 What "Normal" Looks Like</h3>
<p>"Normal" is defined by baselines. A baseline is the range of values that a metric exhibits during typical, healthy operation. Baselines must be established during initial deployment by observing each system under typical workload for at least two weeks.</p>
<p>Baselines are documented for every monitored metric on every system. The baseline document for each system contains:</p>
<ul>
<li>The metric name.</li>
<li>The typical range (e.g., CPU load average: 0.2-0.8).</li>
<li>The typical pattern (e.g., CPU spikes to 2.0 during the daily backup window from 02:00-03:00).</li>
<li>Known exceptions (e.g., disk usage increases by approximately 500 MB per week due to log accumulation).</li>
</ul>
<p>Baselines are recalibrated:</p>
<ul>
<li>After any significant configuration change.</li>
<li>After any hardware change.</li>
<li>After adding or removing a major workload.</li>
<li>At least annually, during the annual operations review.</li>
</ul>
<p>A value outside its baseline is not necessarily a problem. But a value outside its baseline that is not explained by a known exception is an anomaly worth investigating.</p>
<h2 id="5-rules-constraints-3">5. Rules & Constraints</h2>
<ul>
<li><strong>R-D5-005-01:</strong> Every institutional system must be monitored. No system may operate unmonitored.</li>
<li><strong>R-D5-005-02:</strong> The daily health check procedure (Section 4.5) is mandatory. It is performed every day the operator is present. If the operator is absent for more than 48 hours, the first task upon return is to perform the health check and review all alerts generated during the absence.</li>
<li><strong>R-D5-005-03:</strong> Critical alerts must be investigated within one hour of detection. Warning alerts must be investigated within 24 hours. Informational alerts are reviewed during weekly operations.</li>
<li><strong>R-D5-005-04:</strong> Alert thresholds must be calibrated against actual baselines, not default values alone. Default values are starting points, not final values.</li>
<li><strong>R-D5-005-05:</strong> Monitoring data retention must follow the policy in Section 4.2. Alert history is retained indefinitely.</li>
<li><strong>R-D5-005-06:</strong> The monitoring system itself must be monitored. A meta-monitoring check verifies that the monitoring agent is reporting from every system and that the monitoring server is storing and processing data correctly.</li>
<li><strong>R-D5-005-07:</strong> Baselines must be documented for every monitored metric and recalibrated at least annually.</li>
</ul>
<h2 id="6-failure-modes-3">6. Failure Modes</h2>
<ul>
<li><strong>Alert fatigue.</strong> Too many alerts are generated, most of them unactionable. The operator begins ignoring alerts. A genuine critical alert is missed because it is buried in noise. Mitigation: threshold calibration based on actual baselines. If an alert fires frequently without requiring action, the threshold needs adjustment, not the operator's patience.</li>
<li><strong>Silent monitoring failure.</strong> The monitoring agent on a system crashes or stops reporting. If the monitoring system does not detect this absence, the system operates unmonitored without anyone knowing. Mitigation: the meta-monitoring check (R-D5-005-06) detects agent failures. A system that has not reported in more than twice its expected interval generates a critical alert.</li>
<li><strong>Dashboard neglect.</strong> The dashboard exists but the operator stops looking at it. The daily health check is replaced by a quick assumption that "everything is probably fine." Mitigation: the daily check is a procedural requirement, not a suggestion. The operational log records that it was performed.</li>
<li><strong>Baseline staleness.</strong> Baselines are established once and never updated. As the system's workload changes, the baselines become irrelevant. Alerts fire for new-normal values. The operator adjusts by loosening thresholds until they are meaningless. Mitigation: annual baseline recalibration and recalibration after significant changes.</li>
<li><strong>Storage exhaustion of monitoring data.</strong> The monitoring system's own storage fills up, and it begins losing data or failing entirely. Mitigation: monitoring data retention is managed by the retention policy. The monitoring server's own disk usage is a monitored metric with appropriate thresholds.</li>
<li><strong>Cargo cult checking.</strong> The operator performs the daily check but does not actually engage with the data. They go through the motions, record "all nominal" in the log, and leave. Mitigation: the daily check procedure includes specific items to look at (Step 4: disk trends, Step 6: NTP offsets). These items require reading actual values, not merely confirming the dashboard is green.</li>
</ul>
<h2 id="7-recovery-procedures-3">7. Recovery Procedures</h2>
<p><strong>If the monitoring system itself has failed:</strong></p>
<ol>
<li>The monitoring server failure should be detected by the meta-monitoring mechanism (if the monitoring server is also the meta-monitor, this creates a gap -- see Commentary Section).</li>
<li>Verify the monitoring server is operational. Check its system logs, disk space, and service status.</li>
<li>If the monitoring server has crashed, restart it. Verify data collection resumes.</li>
<li>If monitoring data has been lost, document the gap. Manual health checks of all systems should be performed to cover the unmonitored period.</li>
<li>Investigate the cause of the monitoring failure to prevent recurrence.</li>
</ol>
<p><strong>If alert fatigue has developed:</strong></p>
<ol>
<li>Review all active alerts. Classify each as: genuine alert requiring action, recurring nuisance alert, or miscalibrated threshold.</li>
<li>For nuisance alerts, adjust the threshold or investigate the underlying cause. A threshold that fires constantly is either set wrong or revealing a chronic problem.</li>
<li>For miscalibrated thresholds, recalibrate against current baselines.</li>
<li>Document the recalibration in the operational log.</li>
</ol>
<p><strong>If a system has been operating unmonitored:</strong></p>
<ol>
<li>Install or restore the monitoring agent.</li>
<li>Perform a manual health check of the system: check resource utilization, service status, log files, and disk health.</li>
<li>Verify the system's configuration against its baseline (D5-003, D5-006).</li>
<li>Establish or re-establish baselines for the system.</li>
<li>Document the period of unmonitored operation and the results of the manual health check.</li>
</ol>
<h2 id="8-evolution-path-3">8. Evolution Path</h2>
<ul>
<li><strong>Years 0-2:</strong> Baselines are being established. Alert thresholds are being calibrated. The daily check procedure will be refined as the operator learns what matters and what is noise. Expect significant threshold adjustment during this period.</li>
<li><strong>Years 2-5:</strong> The monitoring system should be stable and well-calibrated. The daily check should feel routine. Trending data begins to reveal long-term patterns: seasonal disk growth, hardware degradation curves, workload shifts.</li>
<li><strong>Years 5-15:</strong> SMART data will begin to predict disk failures. Memory and CPU trends will inform capacity planning. The monitoring data archive becomes a valuable historical record of institutional health.</li>
<li><strong>Years 15-30:</strong> The monitoring tools themselves may need replacement. When replacing the monitoring system, preserve the alert history and as much historical data as feasible. The principles -- know what normal looks like, alert on deviations, check every day -- remain constant.</li>
<li><strong>Years 30-50+:</strong> A successor will inherit the monitoring system. The daily check procedure and the dashboard must be comprehensible without oral instruction. The baselines document and the Commentary Section provide the context the successor needs.</li>
</ul>
<h2 id="9-commentary-section-3">9. Commentary Section</h2>
<p><em>This section is reserved for dated entries by current and future operators.</em></p>
<p><strong>2026-02-16 -- Founding Entry:</strong> There is a meta-monitoring problem that this article must be honest about: if the monitoring server is the only system that performs monitoring, then the monitoring server itself is a single point of failure for the entire monitoring function. The meta-monitoring check (R-D5-005-06) helps, but if the monitoring server is completely offline, who detects that?</p>
<p>The practical answer for a single-operator institution is the daily health check. The operator physically looks at the dashboard every day. If the dashboard is down, the operator knows immediately. This is not a sophisticated solution. It is a human solution. And for a single-operator institution, the human is the ultimate monitoring system. The daily check is not just about looking at data. It is about confirming that the systems that collect and present data are themselves alive.</p>
<p>The alert thresholds in Section 4.3 are deliberately conservative. It is better to start with thresholds that alert too often and tighten them over time than to start with thresholds that never alert and discover their inadequacy during a failure. Expect the first few months to require frequent threshold adjustment. This is normal. It is the calibration process, not a flaw.</p>
<h2 id="10-references-3">10. References</h2>
<ul>
<li>ETH-001 -- Ethical Foundations (Principle 6: Honest Accounting of Limitations)</li>
<li>OPS-001 -- Operations Philosophy (daily operations, Section 4.1)</li>
<li>P-001 -- Platform Philosophy and Architectural Principles</li>
<li>P-008 -- System Monitoring and Health</li>
<li>D5-003 -- Core Service Configuration and Hardening (service health checks, logging infrastructure)</li>
<li>D5-004 -- Network Architecture and Segmentation (network monitoring, Section 4.6)</li>
<li>Domain 4 -- Infrastructure & Power (physical environment monitoring)</li>
<li>Domain 12 -- Disaster Recovery (alert-triggered recovery procedures)</li>
</ul>
<hr/>
<hr/>
<h1 id="d5-006-configuration-management-without-internet">D5-006 -- Configuration Management Without Internet</h1>
<p><strong>Document ID:</strong> D5-006 <strong>Domain:</strong> 5 -- Platform & Core Systems <strong>Version:</strong> 1.0.0 <strong>Date:</strong> 2026-02-16 <strong>Status:</strong> Ratified <strong>Depends On:</strong> ETH-001, CON-001, OPS-001, P-001, P-009, D5-002, D5-003, D5-004, D5-005 <strong>Depended Upon By:</strong> All Domain 5 operational articles, all Domain 10 change management articles, all Domain 12 system rebuild articles.</p>
<hr/>
<h2 id="1-purpose-4">1. Purpose</h2>
<p>This article defines how the institution manages system configurations without access to internet-connected tools, cloud-based configuration management services, remote package repositories, or any of the other infrastructure that modern configuration management takes for granted. Configuration management is the discipline of ensuring that every system in the institution is in a known, documented, reproducible state at all times.</p>
<p>The phrase "configuration management" is heavily loaded in modern IT. It typically refers to tools like Ansible, Puppet, Chef, or SaltStack -- tools that pull configurations from central servers, install packages from remote repositories, and enforce desired state through automated agents. These tools assume internet connectivity, or at minimum, connectivity to centralized infrastructure that itself has internet access. An air-gapped institution has neither.</p>
<p>This does not mean configuration management is impossible without internet. It means it looks different. The principles are the same: document the desired state, detect deviations from the desired state, correct deviations, and record changes. The mechanisms are different: version control instead of cloud repositories, manual application instead of automated agents (or locally-hosted automation), and rigorous change procedures instead of "push a commit and let the tool handle it."</p>
<p>This article exists because unmanaged configurations are the primary source of operational unpredictability in long-lived systems. A system whose configuration is not documented, not version-controlled, and not audited is a system that will, over time, become incomprehensible to its operator. And an incomprehensible system is a system that cannot be maintained, cannot be recovered from failure, and cannot be transferred to a successor.</p>
<h2 id="2-scope-4">2. Scope</h2>
<p>This article covers:</p>
<ul>
<li>The version control system for configurations.</li>
<li>Change management procedures for all configuration changes.</li>
<li>The configuration audit process.</li>
<li>How configurations are documented for reproducibility.</li>
<li>How configuration management interacts with the other operational articles (D5-002 through D5-005).</li>
<li>How to manage configurations across multiple systems without centralized automation.</li>
</ul>
<p>This article does NOT cover:</p>
<ul>
<li>The specific configuration baselines for core services (see D5-003).</li>
<li>The process for acquiring new software (see P-002 and D5-002).</li>
<li>Data management and backup procedures (see P-007 and Domain 12).</li>
<li>The selection of version control software (see P-003 and P-009).</li>
</ul>
<h2 id="3-background-4">3. Background</h2>
<p>Configuration management is the art of knowing what your systems look like. Not what you think they look like. Not what they looked like when you set them up. What they look like right now, this moment, and why they look that way.</p>
<p>In a small, air-gapped institution, the temptation is to manage configurations informally. There are only a handful of systems. The operator built them all. Surely they remember how everything is configured? This temptation is the single greatest threat to long-term operational integrity. The operator does not remember. They remember the broad strokes. They forget the detail that took two hours to troubleshoot. They forget the setting that was changed six months ago to work around a bug that has since been fixed. They forget the configuration file that was copied from a forum post and never fully understood.</p>
<p>The broader system administration community learned this lesson decades ago, which is why configuration management tools exist. But those tools were built for internet-connected environments with teams of administrators. This article adapts the principles for a single operator in an air-gapped environment.</p>
<h3 id="31-the-configuration-lifecycle">3.1 The Configuration Lifecycle</h3>
<p>Every configuration in the institution goes through a lifecycle:</p>
<ol>
<li><strong>Creation:</strong> A configuration is written for the first time, usually during initial system deployment.</li>
<li><strong>Documentation:</strong> The configuration is recorded in version control with comments explaining its purpose and rationale.</li>
<li><strong>Deployment:</strong> The configuration is applied to the target system.</li>
<li><strong>Verification:</strong> The applied configuration is verified to match the documented version.</li>
<li><strong>Operation:</strong> The system operates with this configuration.</li>
<li><strong>Change:</strong> A change is needed. The change goes through the change management process (Section 4.2).</li>
<li><strong>Audit:</strong> The actual configuration is compared against the documented version to detect drift (see D5-003, Section 4.3).</li>
<li><strong>Retirement:</strong> The configuration is no longer needed (system decommissioned, service replaced). The configuration is archived, not deleted.</li>
</ol>
<p>Every configuration, at every point in this lifecycle, has a documented state in version control. If a configuration exists on a system but not in version control, that configuration is unauthorized -- even if it works correctly and was applied by the operator.</p>
<h2 id="4-system-model-4">4. System Model</h2>
<h3 id="41-the-version-control-system">4.1 The Version Control System</h3>
<p>All configurations are stored in a local version control system. The specific tool is selected per P-009, but the requirements are:</p>
<ul>
<li><strong>Local operation:</strong> The version control system must function entirely within the air-gapped network. No external server, no cloud service, no remote repository.</li>
<li><strong>Full history:</strong> Every change to every configuration must be preserved with the date, the author, and the reason for the change.</li>
<li><strong>Branching and merging:</strong> The ability to maintain separate branches for testing changes before committing them to the production branch.</li>
<li><strong>Diffing:</strong> The ability to compare any two versions of a configuration and see exactly what changed.</li>
<li><strong>Integrity:</strong> The repository must be checksummed or cryptographically verifiable to detect corruption.</li>
</ul>
<p>The version control repository is hosted on a system in the Core Services segment (VLAN 10) or the Administration segment (VLAN 50). It is backed up as part of the institutional backup strategy. The repository is itself a critical asset -- losing version control history is a significant operational loss.</p>
<p><strong>Repository structure:</strong></p>
<pre><code>/configs/
  /systems/
    /[hostname]/
      /etc/                  -- System configuration files
      /services/             -- Service-specific configuration
      /firewall/             -- Host firewall rules
      /cron/                 -- Scheduled tasks
      /baseline.sha256       -- Hash file for baseline verification
      /README                -- System description, role, dependencies
  /network/
    /vlans/                  -- VLAN definitions
    /firewall-rules/         -- Network-level firewall rules
    /switch-configs/         -- Managed switch configurations
    /topology.txt            -- Current network topology description
  /shared/
    /templates/              -- Configuration templates used across systems
    /scripts/                -- Deployment and verification scripts
    /policies/               -- Configuration policies (password policy, etc.)
  /archive/
    /decommissioned/         -- Configurations of retired systems
    /superseded/             -- Previous versions of replaced configurations</code></pre>
<h3 id="42-the-change-management-process">4.2 The Change Management Process</h3>
<p>Every configuration change -- every change, no matter how small -- follows this process:</p>
<p><strong>Step 1: Propose.</strong> The operator writes a brief change proposal in the operational log. The proposal includes:</p>
<ul>
<li>What is being changed.</li>
<li>Why it is being changed.</li>
<li>What systems are affected.</li>
<li>What the expected impact is.</li>
<li>What the rollback plan is if the change causes problems.</li>
</ul>
<p>For Tier 4 operational decisions (per GOV-001), the proposal may be a single paragraph. For Tier 3 policy decisions, the proposal must include a waiting period per GOV-001. For Tier 2 architectural decisions, the full governance process applies.</p>
<p><strong>Step 2: Implement in version control.</strong> The change is made to the configuration file in version control first, not on the target system. The commit message includes the operational log reference and the rationale for the change.</p>
<p><strong>Step 3: Test.</strong> If a test system is available (and for OS-level and core service changes, one must be per D5-002), the change is applied to the test system first and verified.</p>
<p><strong>Step 4: Deploy.</strong> The changed configuration is applied to the production system. Application may be manual (copying the file and restarting the service) or via a locally-hosted deployment script. The deployment method is documented.</p>
<p><strong>Step 5: Verify.</strong> After deployment, the operator verifies that:</p>
<ul>
<li>The configuration on the target system matches the version in version control (hash comparison).</li>
<li>The affected service is functioning correctly.</li>
<li>No unintended side effects are observed.</li>
</ul>
<p><strong>Step 6: Record.</strong> The operator records the change completion in the operational log, including the verification results. If the change required a rollback, that is recorded as well.</p>
<h3 id="43-manual-vs-automated-deployment">4.3 Manual vs. Automated Deployment</h3>
<p>In an internet-connected environment, configuration management tools automate deployment: the operator commits a change, and the tool propagates it to all affected systems. In an air-gapped institution, automation is limited but not impossible.</p>
<p><strong>Option A: Manual deployment.</strong> The operator copies the configuration file to the target system and applies it. This is the simplest approach and the least error-prone for a small number of systems. The risk is inconsistency: when the same change must be applied to multiple systems, manual deployment may result in slightly different results.</p>
<p><strong>Option B: Local automation.</strong> A locally-hosted automation tool (a simple shell script, a locally-running instance of a configuration management tool, or a custom deployment script) reads the desired configuration from version control and applies it to target systems over the internal network. This is more complex to set up but reduces the risk of inconsistency across systems.</p>
<p>The institution's preference is: use manual deployment until the number of systems makes it impractical, then introduce local automation. Local automation is subject to the same version control and change management requirements as any other configuration. The automation tool's own configuration is version-controlled.</p>
<p>When using manual deployment, the operator must use a checklist for multi-system changes:</p>
<ol>
<li>List all systems that require the change.</li>
<li>Apply the change to each system, in order, checking off each one.</li>
<li>Verify the change on each system using hash comparison.</li>
<li>Record completion for each system in the operational log.</li>
</ol>
<h3 id="44-the-configuration-audit">4.4 The Configuration Audit</h3>
<p>The configuration audit is a comprehensive comparison of every production system's actual configuration against its documented, version-controlled configuration. It is the institutional defense against configuration drift and undocumented changes.</p>
<p><strong>Audit frequency:</strong> Quarterly (integrated with the quarterly operations cycle in OPS-001).</p>
<p><strong>Audit procedure:</strong></p>
<ol>
<li><strong>Generate inventory.</strong> List every system in the institution and its role.</li>
<li><strong>For each system:</strong></li>
<p>   a. Generate cryptographic hashes of all configuration files on the live system.    b. Compare these hashes against the baseline hashes in version control.    c. For any mismatched hash, generate a diff showing the exact changes.    d. Classify each deviation per D5-003, Section 4.3 (authorized, benign, concerning).</p>
<li><strong>For the network:</strong></li>
<p>   a. Dump the current configuration from all managed switches and the firewall appliance.    b. Compare against the version-controlled network configurations.    c. Classify deviations.</p>
<li><strong>For version control itself:</strong></li>
<p>   a. Verify the integrity of the version control repository (run an integrity check).    b. Review the commit log since the last audit. Do all commits have adequate descriptions and operational log references?</p>
<li><strong>Compile the audit report.</strong> The report lists every deviation found, its classification, and the remediation action taken. The report is stored in the operational log and the version control repository.</li>
<li><strong>Remediate.</strong> Authorized deviations update the baseline. Benign deviations update the baseline with documentation. Concerning deviations trigger investigation and, if necessary, a security incident per SEC-001.</li>
</ol>
<h3 id="45-configuration-reproducibility">4.5 Configuration Reproducibility</h3>
<p>The ultimate test of configuration management is reproducibility: can a system be rebuilt from documentation alone, without access to the original system?</p>
<p>Every system's configuration must be documented well enough to pass this test. The documentation includes:</p>
<ol>
<li><strong>The base platform:</strong> Which OS version, which installation profile, which packages. This information is version-controlled and maintained even as the OS is updated (D5-002).</li>
<li><strong>The configuration files:</strong> Every non-default configuration file, in version control.</li>
<li><strong>The deployment order:</strong> In what order must configurations be applied? Are there dependencies (e.g., "create the user before setting the file ownership")?</li>
<li><strong>The verification steps:</strong> How does the operator confirm that the rebuilt system matches the original?</li>
<li><strong>The service startup order:</strong> In what order must services be started, and what must be verified between each?</li>
</ol>
<p>Reproducibility is tested during the annual operations cycle. The test: select one non-critical system, rebuild it from documentation alone, and verify it matches the original. This test reveals documentation gaps that no amount of reading can find.</p>
<h3 id="46-interaction-with-other-operational-articles">4.6 Interaction with Other Operational Articles</h3>
<p>Configuration management interacts with every other operational article in this document:</p>
<ul>
<li><strong>D5-002 (OS Maintenance):</strong> OS updates may change configuration files. After any OS update, drift detection must be run to identify configuration changes introduced by the update. Updated configurations are committed to version control with the update as the rationale.</li>
<li><strong>D5-003 (Core Service Hardening):</strong> The hardening baselines defined in D5-003 are stored in the version control repository. Drift detection (D5-003, Section 4.3) is a subset of the full configuration audit defined here.</li>
<li><strong>D5-004 (Network Architecture):</strong> Network configurations (switch configs, firewall rules, VLAN assignments) are version-controlled with the same rigor as system configurations.</li>
<li><strong>D5-005 (Monitoring):</strong> The monitoring system's own configuration is version-controlled. Changes to alert thresholds, dashboard configurations, and monitoring agent settings follow the change management process.</li>
</ul>
<h2 id="5-rules-constraints-4">5. Rules & Constraints</h2>
<ul>
<li><strong>R-D5-006-01:</strong> Every configuration file on every production system must exist in version control. Configurations that exist on a system but not in version control are unauthorized.</li>
<li><strong>R-D5-006-02:</strong> Every configuration change must follow the change management process in Section 4.2. Emergency changes may abbreviate the proposal step, but must complete all other steps and must document the emergency justification retroactively.</li>
<li><strong>R-D5-006-03:</strong> The configuration audit (Section 4.4) must be performed quarterly.</li>
<li><strong>R-D5-006-04:</strong> Configuration reproducibility must be tested annually by rebuilding a system from documentation alone.</li>
<li><strong>R-D5-006-05:</strong> The version control repository must be backed up as a critical institutional asset. Loss of version control history is a significant operational incident.</li>
<li><strong>R-D5-006-06:</strong> Every commit to the configuration repository must include a description of the change and a reference to the operational log entry that authorized it.</li>
<li><strong>R-D5-006-07:</strong> The configuration repository must maintain full history. History-rewriting operations (force push, rebase that discards commits) are prohibited.</li>
</ul>
<h2 id="6-failure-modes-4">6. Failure Modes</h2>
<ul>
<li><strong>Configuration drift accumulation.</strong> Configurations are changed on live systems without being committed to version control. Over time, the version control repository describes a system that no longer exists. Mitigation: quarterly audits (R-D5-006-03) and the discipline of always changing version control first, then deploying (Section 4.2, Step 2).</li>
<li><strong>Version control neglect.</strong> The repository exists but is not used. Configurations are managed informally, in the operator's memory. Mitigation: R-D5-006-01 makes version-controlled configuration a hard requirement, not a best practice. The quarterly audit will reveal neglect immediately.</li>
<li><strong>Repository corruption.</strong> The version control repository becomes corrupted (disk failure, software bug). Configuration history is lost. Mitigation: the repository is backed up (R-D5-006-05). The backup includes the full repository with complete history. Backup integrity is verified quarterly (OPS-001).</li>
<li><strong>Change management bypass.</strong> Under time pressure, the operator skips the change management process and modifies a production system directly. The change works, so it is never documented. Mitigation: the configuration audit will detect the undocumented change. Emergency changes are permitted but must be documented retroactively (R-D5-006-02).</li>
<li><strong>Documentation-reality divorce.</strong> The documentation is thorough but does not match reality because it was written aspirationally ("this is how we want it to be") rather than descriptively ("this is how it actually is"). Mitigation: the reproducibility test (R-D5-006-04) is the cure. If the system rebuilt from documentation does not match the production system, the documentation is wrong.</li>
<li><strong>Over-complexity in automation.</strong> The operator builds an elaborate local automation system that becomes itself a source of complexity and fragility. The automation tool breaks, and the operator cannot manage configurations manually because they have forgotten how. Mitigation: automation is introduced only when manual deployment becomes impractical (Section 4.3). Manual deployment skills must be maintained regardless of automation status.</li>
</ul>
<h2 id="7-recovery-procedures-4">7. Recovery Procedures</h2>
<p><strong>If the version control repository has been corrupted or lost:</strong></p>
<ol>
<li>Restore the repository from the most recent backup.</li>
<li>Identify any changes made between the backup and the corruption event by comparing the restored repository against live system configurations.</li>
<li>Commit any identified changes to the restored repository with notes indicating they were recovered after a repository incident.</li>
<li>Verify repository integrity after restoration.</li>
<li>Document the incident, the data loss (if any), and the restoration in the operational log.</li>
<li>Review the backup strategy for the repository -- was the backup frequency sufficient?</li>
</ol>
<p><strong>If configuration drift has been discovered during an audit:</strong></p>
<ol>
<li>For each drifted configuration, determine whether the live system or the repository contains the correct version.</li>
<li>If the live system is correct (an undocumented but intentional change), commit the live configuration to the repository with full documentation of the change and its rationale. Add a note that the change was documented retroactively.</li>
<li>If the repository is correct (an unintentional change on the live system), restore the repository version to the live system and verify.</li>
<li>If the correct version is uncertain, investigate. Check the operational log, check system logs, check if the change correlates with any maintenance activity. Do not commit or restore until the correct version is determined.</li>
<li>Document every resolution in the audit report.</li>
</ol>
<p><strong>If a system must be rebuilt and the documentation is incomplete:</strong></p>
<ol>
<li>If other systems with similar roles exist, use their configurations as a reference.</li>
<li>Rebuild to the closest approximation possible from documentation.</li>
<li>Test thoroughly before placing the rebuilt system in production.</li>
<li>Document everything that was missing from the original documentation and add it to the repository.</li>
<li>Treat this as a documentation failure and review the reproducibility testing process to ensure it catches such gaps in the future.</li>
</ol>
<p><strong>If the change management process has been consistently bypassed:</strong></p>
<ol>
<li>Acknowledge the failure in the operational log.</li>
<li>Perform a full configuration audit immediately.</li>
<li>Document all undocumented changes.</li>
<li>Investigate why the process was bypassed. Was it too burdensome? Too slow? Too complex? If so, revise the process (Tier 3 governance decision) to make it practical while maintaining its essential requirements.</li>
<li>Resume the process. Do not declare the problem solved until at least two quarterly audits show compliance.</li>
</ol>
<h2 id="8-evolution-path-4">8. Evolution Path</h2>
<ul>
<li><strong>Years 0-2:</strong> The version control repository is being populated for the first time. Every system deployment generates configuration artifacts that must be committed. The change management process will feel cumbersome. Follow it anyway. The habits formed now define the institution's configuration culture.</li>
<li><strong>Years 2-5:</strong> The repository is comprehensive. The quarterly audits should show minimal drift. The reproducibility test should succeed for most systems. The focus shifts from establishing the process to refining it.</li>
<li><strong>Years 5-15:</strong> The repository contains a rich history of how the institution's configuration has evolved. This history becomes valuable during troubleshooting ("When did this setting change? What was it before?") and during planning ("How has this system's resource configuration grown over time?"). The repository is no longer just a management tool. It is institutional memory.</li>
<li><strong>Years 15-30:</strong> Version control tools may have changed. If the tool is replaced, the full history must be migrated to the new tool. Configuration history is a critical institutional asset that spans the lifetime of the institution, not the lifetime of any particular tool.</li>
<li><strong>Years 30-50+:</strong> A successor will inherit the repository. The repository, its structure, and the change management process must be comprehensible without oral instruction. The README files in the repository and the Commentary Section of this article provide the context the successor needs. The repository is, in a real sense, a letter to the future.</li>
</ul>
<h2 id="9-commentary-section-4">9. Commentary Section</h2>
<p><em>This section is reserved for dated entries by current and future operators.</em></p>
<p><strong>2026-02-16 -- Founding Entry:</strong> The most important sentence in this article is in Section 4.2, Step 2: "The change is made to the configuration file in version control first, not on the target system." This is counterintuitive. The natural workflow is to change the system, verify it works, and then document it. But that workflow creates a window where the live system and the documented configuration diverge. That window is where configuration drift begins. By changing version control first, you ensure that the repository is always at least as current as the live systems. The reverse -- live systems leading the repository -- is the path to eventual documentation fiction.</p>
<p>The quarterly audit will, in the early years, consistently find drift. This is not failure. It is the audit working. Every audit that finds drift and corrects it is the process functioning as designed. Worry when the audits stop finding anything -- that either means the process has been perfected (unlikely in the first few years) or the audits are not being performed thoroughly enough.</p>
<p>On the question of local automation: resist the urge to build elaborate tooling. For an institution with a handful of systems, a well-organized repository and disciplined manual deployment are more reliable than a fragile automation system that the operator does not fully understand. Automation should be introduced when the pain of manual deployment exceeds the pain of maintaining automation -- and not a moment before.</p>
<h2 id="10-references-4">10. References</h2>
<ul>
<li>ETH-001 -- Ethical Foundations (Principle 3: Transparency of Operation)</li>
<li>CON-001 -- The Founding Mandate (self-built, self-understood infrastructure)</li>
<li>OPS-001 -- Operations Philosophy (documentation-first principle, operational tempo)</li>
<li>P-001 -- Platform Philosophy and Architectural Principles</li>
<li>P-009 -- Configuration Management and Reproducibility</li>
<li>D5-002 -- Operating System Maintenance Procedures (update-triggered configuration changes)</li>
<li>D5-003 -- Core Service Configuration and Hardening (configuration baselines and drift detection)</li>
<li>D5-004 -- Network Architecture and Segmentation (network configuration management)</li>
<li>D5-005 -- System Monitoring and Alerting (monitoring configuration management)</li>
<li>GOV-001 -- Authority Model (governance tiers for configuration changes)</li>
<li>Domain 12 -- Disaster Recovery (system rebuild from configuration documentation)</li>
</ul>
<hr/>
<p><em>End of Stage 3 Platform Operations -- Five Operational Doctrine Articles</em></p>
<p><strong>Document Total:</strong> 5 articles (D5-002 through D5-006) <strong>Status:</strong> All five articles ratified as of 2026-02-16. <strong>Next:</strong> Additional Stage 3 articles for remaining Domain 5 topics and other operational domains.</p>
</main>
</div>
<footer class="site-footer">
<div class="footer-inner">
<p>holm.chat Documentation Institution &mdash; Air-Gapped, Off-Grid, Self-Built</p>
<p>Stage 1: Documentation Framework &mdash; Version 1.0.0 &mdash; 2026-02-16</p>
</div>
</footer>
</body>
</html>